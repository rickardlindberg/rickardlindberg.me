<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>
      Gists | Rickard's personal homepage
    </title>

    <meta name="keywords" content="programming, writing" />
    <meta name="description" content="Rickard's personal homepage.">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <link rel="stylesheet" href="../css/blueprint/screen.css" type="text/css" media="screen, projection">
    <link rel="stylesheet" href="../css/blueprint/print.css" type="text/css" media="print">
    <!--[if lt IE 8]>
      <link rel="stylesheet" href="/css/blueprint/ie.css" type="text/css" media="screen, projection">
    <![endif]-->
    <link rel="stylesheet" href="../css/layout.css" type="text/css" media="screen, projection">
    <link rel="stylesheet" href="../css/syntax.css" type="text/css">
  </head>
  <body>
    <div class="container noshowgrid">
      <div class="span-16 prepend-4 append-4">
        <h1>Gists</h1>

<p>On this page I collect interesting pieces of code.</p>
<h2 id="link-checker">Link checker</h2>
<p><strong>Added 22 November 2014.</strong></p>
<p>This Python script is used to check a web page for broken links. I wrote it to be used in a workshop about continuous integration with Jenkins.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> re
<span class="ch">import</span> requests
<span class="ch">import</span> sys
<span class="ch">import</span> urlparse

TIMEOUT_IN_SECONDS = <span class="fl">10.0</span>

<span class="kw">def</span> check(base_url):
    <span class="dt">print</span>(<span class="st">&quot;Checking </span><span class="ot">%s</span><span class="st">&quot;</span> % base_url)
    base_response = requests.get(base_url, timeout=TIMEOUT_IN_SECONDS)
    <span class="kw">assert</span> base_response.status_code == <span class="dv">200</span>
    <span class="kw">assert</span> base_response.headers[<span class="st">&quot;Content-Type&quot;</span>].startswith(<span class="st">&quot;text/&quot;</span>)
    <span class="kw">for</span> link_match in re.finditer(<span class="st">r&quot;&lt;a.*?href=\&quot;(.*?)\&quot;&quot;</span>, base_response.text):
        link_url = urlparse.urljoin(base_url, link_match.group(<span class="dv">1</span>))
        <span class="kw">if</span> link_url.startswith(<span class="st">&quot;http&quot;</span>):
            <span class="dt">print</span>(<span class="st">&quot;  </span><span class="ot">%s</span><span class="st">&quot;</span> % link_url)
            link_response = requests.get(link_url, timeout=TIMEOUT_IN_SECONDS)
            <span class="kw">assert</span> link_response.status_code == <span class="dv">200</span>

<span class="kw">if</span> <span class="ot">__name__</span> == <span class="st">&quot;__main__&quot;</span>:
    <span class="kw">for</span> base_url in sys.argv[<span class="dv">1</span>:]:
        check(base_url)</code></pre>
<p>Examples:</p>
<pre><code>python check.py http://gnome.org
python check.py http://google.com http://duckduckgo.com</code></pre>

        <hr>
        <p><a href="../">Home</a></p>
        <hr>
        <p>Site proudly generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>.</p>
      </div>
    </div>
  </body>
</html>
