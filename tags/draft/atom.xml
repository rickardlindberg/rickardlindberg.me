<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>Rickard's personal homepage: latest posts tagged draft</title>
    <link href="http://rickardlindberg.me/tags/draft/atom.xml" rel="self" />
    <link href="http://rickardlindberg.me" />
    <id>http://rickardlindberg.me/tags/draft/atom.xml</id>
    <author>
        <name>Rickard Lindberg</name>
        <email>rickard@rickardlindberg.me</email>
    </author>
    <updated>2021-12-10T00:00:00Z</updated>
    <entry>
    <title>DRAFT: RLMeta Poster 2</title>
    <link href="http://rickardlindberg.me/writing/rlmeta-poster2/" />
    <id>http://rickardlindberg.me/writing/rlmeta-poster2/</id>
    <published>2021-12-10T00:00:00Z</published>
    <updated>2021-12-10T00:00:00Z</updated>
    <summary type="html"><![CDATA[<h1>DRAFT: RLMeta Poster 2</h1>

<p><em>Published on 10 December 2021.</em></p>

<p><strong>This is a work in progress that will change. Like to see it finished? Let me know by sending me an email.</strong></p>
<p>A while ago I created a <a href="/writing/creating-rlmeta-poster/index.html">poster</a> to showcase RLMeta. The version of RLMeta on the poster is based on the version from the <a href="/writing/rlmeta-memoize-failures/index.html">memoizing failures</a> article, but I made it smaller and more beautiful to better fit the poster. To be able to finish the poster, I had to stop making changes and put the source code on the poster. That was difficult because I felt the need for it to be perfect. Eventually I did stop polishing, and left a few items unresolved.</p>
<p>Almost immediately after I finished the poster, I started working on a second version. Initially, my plan was to make a second version of the poster. I started to fix the unresolved items and I was making progress. But somehow imperfections kept creeping in. It felt like a never ending game of chasing perfection. That’s when I decided that a second poster was probably not going to be worth it. But I still liked the new version of RLMeta.</p>
<p>Instead, I decided to attempt to present the new version in the style of a code walk through. In other words, another way to showcase RLMeta that is also a bit more practical. Compared to the poster version, this version could also be more easily improved because rendering the blog post is automatic whereas creating the layout of a poster requires manual work every time the source code changes. I also wanted to experiment with the walk through format because I thought it could be something worth putting into the README of a project.</p>
<p>The rest of this blog post consists of the walk through of the new version of RLMeta and a section on the most important changes from the poster version and motivations for them.</p>
<h2 id="getting-rlmeta">Getting RLMeta</h2>
<p>In order to follow along on this walk through, you need to download this version of RLMeta from here: <a href="rlmeta-poster-2.zip">rlmeta-poster-2.zip</a>.</p>
<h2 id="file-structure">File structure</h2>
<p>The zip file consists of the source code, a make script, and the RLMeta compiler:</p>
<div class="highlight">
<pre><span></span>$ <span></span>tree --dirsfirst
<span></span>.
├── src
│   ├── assembler.rlmeta
│   ├── codegenerator.rlmeta
│   ├── main.py
│   ├── parser.rlmeta
│   └── support.py
├── make.py
└── rlmeta.py

1 directory, 7 files
</pre>
</div>
<p>The size of the source code is quite small:</p>
<div class="highlight">
<pre><span></span>$ <span></span>wc -l src/*
<span></span>   39 src/assembler.rlmeta
   57 src/codegenerator.rlmeta
   26 src/main.py
   60 src/parser.rlmeta
  237 src/support.py
  419 total
</pre>
</div>
<p>The RLMeta compiler can be created from this source code only. We will see how later in this walk through.</p>
<h2 id="exploring-rlmeta">Exploring RLMeta</h2>
<p>Before we dive into how the RLMeta compiler is created, let’s explore RLMeta by writing a small, but real, program in it.</p>
<p>What types of programs can we write in RLMeta?</p>
<p>In RLMeta, we write grammars. Grammars have rules that specify how to match objects from an input stream and specify what should happen when objects are matched.</p>
<p>Let’s write a grammar that counts the number of objects in an input stream and produces a report:</p>
<div class="highlight">
<pre><span></span>$ <span></span>cat object_counter.grammar
<span></span>ObjectCounter {
  count <span class="nb">=</span> <span class="nc">.*</span><span class="nb">:</span>xs <span class="nb">-&gt;</span> { <span class="s">&quot;number of objects = &quot;</span> len(xs) }
}
</pre>
</div>
<p>Compiling this grammar gives a Python class with the same name:</p>
<div class="highlight">
<pre><span></span>$ <span></span>python rlmeta.py --compile object_counter.grammar
<span></span><span class="k">class</span> <span class="nc">ObjectCounter</span><span class="p">(</span><span class="n">Grammar</span><span class="p">):</span>
    <span class="n">rules</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
    <span class="n">code</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">PUSH_SCOPE</span><span class="p">,</span>
        <span class="n">LIST_START</span><span class="p">,</span>
        <span class="n">BACKTRACK</span><span class="p">,</span>
        <span class="mi">10</span><span class="p">,</span>
        <span class="n">MATCH</span><span class="p">,</span>
        <span class="s1">&#39;any&#39;</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">LIST_APPEND</span><span class="p">,</span>
        <span class="n">COMMIT</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="n">LIST_END</span><span class="p">,</span>
        <span class="n">BIND</span><span class="p">,</span>
        <span class="s1">&#39;xs&#39;</span><span class="p">,</span>
        <span class="n">ACTION</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="n">join</span><span class="p">([</span><span class="s1">&#39;number of objects = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s1">&#39;len&#39;</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s1">&#39;xs&#39;</span><span class="p">))]),</span>
        <span class="n">POP_SCOPE</span><span class="p">,</span>
        <span class="n">RETURN</span>
    <span class="p">]</span>
</pre>
</div>
<p>Don’t worry about understanding the generated code now. We will explore it more later. Just note that the generated class inherits from a class called <code>Grammar</code> and that is uses some constants like <code>PUSH_SCOPE</code> and <code>LIST_START</code>. These things are defined in a support library which can be generated by the RLMeta compiler with the <code>--support</code> option:</p>
<div class="highlight">
<pre><span></span>$ <span></span>python rlmeta.py --support <span class="p">|</span> grep <span class="s1">&#39;^\(class\|def\)&#39;</span>
<span></span><span class="k">class</span> <span class="nc">VM</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">PUSH_SCOPE</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">POP_SCOPE</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">BACKTRACK</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">COMMIT</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">CALL</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">CALL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">pc</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">RETURN</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">MATCH</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">MATCH_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">MATCH_CALL_RULE</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">LIST_START</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">LIST_APPEND</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">LIST_END</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">BIND</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">ACTION</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">PUSH_STREAM</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">POP_STREAM</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">FAIL</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">FAIL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">fail_message</span><span class="p">):</span>
<span class="k">class</span> <span class="nc">SemanticAction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="k">class</span> <span class="nc">MatchError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="k">class</span> <span class="nc">Grammar</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="k">class</span> <span class="nc">Runtime</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
<span class="k">class</span> <span class="nc">Counter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">splice</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="n">lists</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">indent</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;    &quot;</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">compile_chain</span><span class="p">(</span><span class="n">grammars</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
</pre>
</div>
<p>To create a complete program, we also have to write a main function that instantiates the <code>ObjectCounter</code> grammar and invokes its <code>count</code> rule.</p>
<p>Here is an example that passes stdin as the input stream to the <code>count</code> rule and prints the result to stdout:</p>
<div class="highlight">
<pre><span></span>$ <span></span>cat object_counter_main.py
<span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
  <span class="kn">import</span> <span class="nn">sys</span>
  <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ObjectCounter</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
</pre>
</div>
<p>TODO: explain <code>--copy</code> option</p>
<p>Combining these pieces in a single compile command looks like this:</p>
<div class="highlight">
<pre><span></span>$ <span></span>python rlmeta.py --support --compile object_counter.grammar --copy object_counter_main.py &gt; object_counter.py
<span></span>
</pre>
</div>
<p>Note that the support library must come before the grammar so that <code>Grammar</code> is defined by the time <code>ObjectCounter</code> is evaluated.</p>
<p>The object counter source code has now been compiled into a standalone Python program that can be run like this:</p>
<div class="highlight">
<pre><span></span>$ <span></span><span class="nb">echo</span> <span class="s1">&#39;hello&#39;</span> <span class="p">|</span> python object_counter.py
<span></span>number of objects = 6
</pre>
</div>
<div class="highlight">
<pre><span></span>$ <span></span><span class="nb">echo</span> <span class="s1">&#39;this is longer&#39;</span> <span class="p">|</span> python object_counter.py
<span></span>number of objects = 15
</pre>
</div>
<p>So programs in RLMeta are written mainly in grammar files with some support functions written in Python. The RLMeta compiler can process all these files to produce a single Python file which is the compiled program.</p>
<h2 id="compiling-rlmeta-itself">Compiling RLMeta itself</h2>
<p>Now that we have an understanding of the RLMeta compiler, let’s see how we can create it from the source code. Here is the full command:</p>
<div class="highlight">
<pre><span></span>$ <span></span>python rlmeta.py --embed SUPPORT src/support.py --support --compile src/parser.rlmeta --compile src/codegenerator.rlmeta --compile src/assembler.rlmeta --copy src/main.py &gt; rlmeta-raw.py
<span></span>
</pre>
</div>
<p>Let’s break it down:</p>
<ul>
<li>First we invoke the compiler: <code>python rlmeta.py</code>.</li>
<li>The first argument <code>--embed SUPPORT src/support.py</code> tells the compiler to generate a Python variable named <code>SUPPORT</code> containing the contents of the file <code>src/suppor.py</code>. Needed to be able to generate the support library.</li>
<li>The next argument <code>--support</code> tells the compiler to generate the support library that is embedded in the compiler.</li>
<li>The <code>--compile ...</code> arguments tell the compiler to compile the given grammar files.</li>
<li>The last argument, <code>--copy src/main.py</code> tells the compiler to copy the file verbatim.</li>
</ul>
<p>The make script can be called with the <code>compile</code> argument to perform this exact function:</p>
<div class="highlight">
<pre><span></span>$ <span></span>./make.py compile &gt; rlmeta-compile.py
<span></span>
</pre>
</div>
<p>And all these files are exactly the same:</p>
<div class="highlight">
<pre><span></span>$ <span></span>md5sum rlmeta.py rlmeta-compile.py rlmeta-raw.py
<span></span>8f438ec43dc93d0297415c7ddbcc683c  rlmeta.py
8f438ec43dc93d0297415c7ddbcc683c  rlmeta-compile.py
8f438ec43dc93d0297415c7ddbcc683c  rlmeta-raw.py
</pre>
</div>
<p>Thus, the RLMeta compiler reproduced itself exactly from the source code.</p>
<h2 id="the-usage-of-the-make-script">The usage of the make script</h2>
<h2 id="code">Code</h2>
<div class="highlight">
<pre><span></span>Parser {
  file <span class="nb">=</span>
    <span class="nb">|</span> (space grammar)<span class="nc">*</span><span class="nb">:</span>xs space <span class="nc">!.</span>            <span class="nb">-&gt;</span> xs
  grammar <span class="nb">=</span>
    <span class="nb">|</span> name<span class="nb">:</span>x space <span class="sc">&#39;{&#39;</span> rule<span class="nc">*</span><span class="nb">:</span>ys space <span class="sc">&#39;}&#39;</span>     <span class="nb">-&gt;</span> [<span class="s">&quot;Grammar&quot;</span> x <span class="nc">~</span>ys]
  rule <span class="nb">=</span>
    <span class="nb">|</span> name<span class="nb">:</span>x space <span class="sc">&#39;=&#39;</span> choice<span class="nb">:</span>y               <span class="nb">-&gt;</span> [<span class="s">&quot;Rule&quot;</span> x y]
  choice <span class="nb">=</span>
    <span class="nb">|</span> (space <span class="sc">&#39;|&#39;</span>)<span class="nc">?</span>
      sequence<span class="nb">:</span>x (space <span class="sc">&#39;|&#39;</span> sequence)<span class="nc">*</span><span class="nb">:</span>xs     <span class="nb">-&gt;</span> [<span class="s">&quot;Or&quot;</span> x <span class="nc">~</span>xs]
  sequence <span class="nb">=</span>
    <span class="nb">|</span> expr<span class="nc">*</span><span class="nb">:</span>xs maybeAction<span class="nb">:</span>ys                 <span class="nb">-&gt;</span> [<span class="s">&quot;Scope&quot;</span> [<span class="s">&quot;And&quot;</span> <span class="nc">~</span>xs <span class="nc">~</span>ys]]
  expr <span class="nb">=</span>
    <span class="nb">|</span> expr1<span class="nb">:</span>x space <span class="sc">&#39;:&#39;</span> name<span class="nb">:</span>y                <span class="nb">-&gt;</span> [<span class="s">&quot;Bind&quot;</span> y x]
    <span class="nb">|</span> expr1
  expr1 <span class="nb">=</span>
    <span class="nb">|</span> expr2<span class="nb">:</span>x space <span class="sc">&#39;*&#39;</span>                       <span class="nb">-&gt;</span> [<span class="s">&quot;Star&quot;</span> x]
    <span class="nb">|</span> expr2<span class="nb">:</span>x space <span class="sc">&#39;?&#39;</span>                       <span class="nb">-&gt;</span> [<span class="s">&quot;Or&quot;</span> x [<span class="s">&quot;And&quot;</span>]]
    <span class="nb">|</span> space <span class="sc">&#39;!&#39;</span> expr2<span class="nb">:</span>x                       <span class="nb">-&gt;</span> [<span class="s">&quot;Not&quot;</span> x]
    <span class="nb">|</span> space <span class="sc">&#39;%&#39;</span>                               <span class="nb">-&gt;</span> [<span class="s">&quot;MatchCallRule&quot;</span>]
    <span class="nb">|</span> expr2
  expr2 <span class="nb">=</span>
    <span class="nb">|</span> name<span class="nb">:</span>x <span class="nc">!</span>(space <span class="sc">&#39;=&#39;</span>)                     <span class="nb">-&gt;</span> [<span class="s">&quot;MatchRule&quot;</span> x]
    <span class="nb">|</span> space char<span class="nb">:</span>x <span class="sc">&#39;-&#39;</span> char<span class="nb">:</span>y                 <span class="nb">-&gt;</span> [<span class="s">&quot;MatchObject&quot;</span> [<span class="s">&quot;Range&quot;</span> x y]]
    <span class="nb">|</span> space <span class="sc">&#39;</span><span class="se">\&#39;</span><span class="sc">&#39;</span> (<span class="nc">!</span><span class="sc">&#39;</span><span class="se">\&#39;</span><span class="sc">&#39;</span> matchChar)<span class="nc">*</span><span class="nb">:</span>xs <span class="sc">&#39;</span><span class="se">\&#39;</span><span class="sc">&#39;</span>   <span class="nb">-&gt;</span> [<span class="s">&quot;And&quot;</span> <span class="nc">~</span>xs]
    <span class="nb">|</span> space <span class="sc">&#39;.&#39;</span>                               <span class="nb">-&gt;</span> [<span class="s">&quot;MatchObject&quot;</span> [<span class="s">&quot;Any&quot;</span>]]
    <span class="nb">|</span> space <span class="sc">&#39;(&#39;</span> choice<span class="nb">:</span>x space <span class="sc">&#39;)&#39;</span>            <span class="nb">-&gt;</span> x
    <span class="nb">|</span> space <span class="sc">&#39;[&#39;</span> expr<span class="nc">*</span><span class="nb">:</span>xs space <span class="sc">&#39;]&#39;</span>            <span class="nb">-&gt;</span> [<span class="s">&quot;MatchList&quot;</span> [<span class="s">&quot;And&quot;</span> <span class="nc">~</span>xs]]
  matchChar <span class="nb">=</span>
    <span class="nb">|</span> innerChar<span class="nb">:</span>x                             <span class="nb">-&gt;</span> [<span class="s">&quot;MatchObject&quot;</span> [<span class="s">&quot;Eq&quot;</span> x]]
  maybeAction <span class="nb">=</span>
    <span class="nb">|</span> actionExpr<span class="nb">:</span>x                            <span class="nb">-&gt;</span> [[<span class="s">&quot;Action&quot;</span> x]]
    <span class="nb">|</span>                                         <span class="nb">-&gt;</span> []
  actionExpr <span class="nb">=</span>
    <span class="nb">|</span> space <span class="sc">&#39;-&gt;&#39;</span> hostExpr<span class="nb">:</span>x
      (space <span class="sc">&#39;:&#39;</span> name <span class="nb">|</span> <span class="nb">-&gt;</span> <span class="s">&quot;&quot;</span>)<span class="nb">:</span>y actionExpr<span class="nb">:</span>z <span class="nb">-&gt;</span> [<span class="s">&quot;Set&quot;</span> y x z]
    <span class="nb">|</span> space <span class="sc">&#39;-&gt;&#39;</span> hostExpr<span class="nb">:</span>x                   <span class="nb">-&gt;</span> x
  hostExpr <span class="nb">=</span>
    <span class="nb">|</span> space string<span class="nb">:</span>x                          <span class="nb">-&gt;</span> [<span class="s">&quot;String&quot;</span> x]
    <span class="nb">|</span> space <span class="sc">&#39;[&#39;</span> hostListItem<span class="nc">*</span><span class="nb">:</span>xs space <span class="sc">&#39;]&#39;</span>    <span class="nb">-&gt;</span> [<span class="s">&quot;List&quot;</span> <span class="nc">~</span>xs]
    <span class="nb">|</span> space <span class="sc">&#39;{&#39;</span> formatExpr<span class="nc">*</span><span class="nb">:</span>xs space <span class="sc">&#39;}&#39;</span>      <span class="nb">-&gt;</span> [<span class="s">&quot;Format&quot;</span> <span class="nc">~</span>xs]
    <span class="nb">|</span> var<span class="nb">:</span>x space <span class="sc">&#39;(&#39;</span> hostExpr<span class="nc">*</span><span class="nb">:</span>ys space <span class="sc">&#39;)&#39;</span>  <span class="nb">-&gt;</span> [<span class="s">&quot;Call&quot;</span> x <span class="nc">~</span>ys]
    <span class="nb">|</span> var<span class="nb">:</span>x
  hostListItem <span class="nb">=</span>
    <span class="nb">|</span> space <span class="sc">&#39;~&#39;</span><span class="nc">*</span><span class="nb">:</span>ys hostExpr<span class="nb">:</span>x                <span class="nb">-&gt;</span> [<span class="s">&quot;ListItem&quot;</span> len(ys) x]
  formatExpr <span class="nb">=</span>
    <span class="nb">|</span> space <span class="sc">&#39;&gt;&#39;</span> formatExpr<span class="nc">*</span><span class="nb">:</span>xs space <span class="sc">&#39;&lt;&#39;</span>      <span class="nb">-&gt;</span> [<span class="s">&quot;Indent&quot;</span> [<span class="s">&quot;Format&quot;</span> <span class="nc">~</span>xs]]
    <span class="nb">|</span> hostExpr
  var <span class="nb">=</span>
    <span class="nb">|</span> name<span class="nb">:</span>x <span class="nc">!</span>(space <span class="sc">&#39;=&#39;</span>)                     <span class="nb">-&gt;</span> [<span class="s">&quot;Lookup&quot;</span> x]
  string    <span class="nb">=</span> <span class="sc">&#39;&quot;&#39;</span>  (<span class="nc">!</span><span class="sc">&#39;&quot;&#39;</span>  innerChar)<span class="nc">*</span><span class="nb">:</span>xs <span class="sc">&#39;&quot;&#39;</span>  <span class="nb">-&gt;</span> { xs }
  char      <span class="nb">=</span> <span class="sc">&#39;</span><span class="se">\&#39;</span><span class="sc">&#39;</span>  <span class="nc">!</span><span class="sc">&#39;</span><span class="se">\&#39;</span><span class="sc">&#39;</span> innerChar  <span class="nb">:</span>x  <span class="sc">&#39;</span><span class="se">\&#39;</span><span class="sc">&#39;</span> <span class="nb">-&gt;</span> x
  innerChar <span class="nb">=</span> <span class="sc">&#39;</span><span class="se">\\</span><span class="sc">&#39;</span> escape <span class="nb">|</span> <span class="nc">.</span>
  escape    <span class="nb">=</span> <span class="sc">&#39;</span><span class="se">\\</span><span class="sc">&#39;</span> <span class="nb">-&gt;</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span> <span class="nb">|</span> <span class="sc">&#39;</span><span class="se">\&#39;</span><span class="sc">&#39;</span> <span class="nb">-&gt;</span> <span class="s">&quot;&#39;&quot;</span>
            <span class="nb">|</span> <span class="sc">&#39;&quot;&#39;</span>  <span class="nb">-&gt;</span> <span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&quot;</span> <span class="nb">|</span> <span class="sc">&#39;n&#39;</span>  <span class="nb">-&gt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
  name      <span class="nb">=</span> space nameStart<span class="nb">:</span>x nameChar<span class="nc">*</span><span class="nb">:</span>xs  <span class="nb">-&gt;</span> { x xs }
  nameStart <span class="nb">=</span> <span class="sc">&#39;a&#39;</span><span class="nc">-</span><span class="sc">&#39;z&#39;</span> <span class="nb">|</span> <span class="sc">&#39;A&#39;</span><span class="nc">-</span><span class="sc">&#39;Z&#39;</span>
  nameChar  <span class="nb">=</span> <span class="sc">&#39;a&#39;</span><span class="nc">-</span><span class="sc">&#39;z&#39;</span> <span class="nb">|</span> <span class="sc">&#39;A&#39;</span><span class="nc">-</span><span class="sc">&#39;Z&#39;</span> <span class="nb">|</span> <span class="sc">&#39;0&#39;</span><span class="nc">-</span><span class="sc">&#39;9&#39;</span>
  space     <span class="nb">=</span> (<span class="sc">&#39; &#39;</span> <span class="nb">|</span> <span class="sc">&#39;</span><span class="se">\n</span><span class="sc">&#39;</span>)<span class="nc">*</span>
}
</pre>
</div>
<div class="highlight">
<pre><span></span>CodeGenerator {
  Grammar       <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x ast<span class="nc">*</span><span class="nb">:</span>ys <span class="nb">-&gt;</span> [<span class="s">&quot;Grammar&quot;</span> x <span class="nc">~~</span>ys]
  Rule          <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x ast<span class="nb">:</span>y   <span class="nb">-&gt;</span> [[<span class="s">&quot;Rule&quot;</span> x]
                                  <span class="nc">~</span>y
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;RETURN&quot;</span>]]
  Or            <span class="nb">=</span>
    <span class="nb">|</span> ast<span class="nb">:</span>x Or<span class="nb">:</span>y              <span class="nb">-&gt;</span> label()<span class="nb">:</span>a <span class="nb">-&gt;</span> label()<span class="nb">:</span>b
                              <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;BACKTRACK&quot;</span>]
                                  [<span class="s">&quot;Target&quot;</span> a]
                                  <span class="nc">~</span>x
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;COMMIT&quot;</span>]
                                  [<span class="s">&quot;Target&quot;</span> b]
                                  [<span class="s">&quot;Label&quot;</span> a]
                                  <span class="nc">~</span>y
                                  [<span class="s">&quot;Label&quot;</span> b]]
    <span class="nb">|</span> ast
  Scope         <span class="nb">=</span> ast<span class="nb">:</span>x       <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;PUSH_SCOPE&quot;</span>]
                                  <span class="nc">~</span>x
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;POP_SCOPE&quot;</span>]]
  And           <span class="nb">=</span> ast<span class="nc">*</span><span class="nb">:</span>xs     <span class="nb">-&gt;</span> [<span class="nc">~~</span>xs]
  Bind          <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x ast<span class="nb">:</span>y   <span class="nb">-&gt;</span> [<span class="nc">~</span>y
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;BIND&quot;</span>]
                                  [<span class="s">&quot;Value&quot;</span> x]]
  Star          <span class="nb">=</span> ast<span class="nb">:</span>x       <span class="nb">-&gt;</span> label()<span class="nb">:</span>a <span class="nb">-&gt;</span> label()<span class="nb">:</span>b
                              <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;LIST_START&quot;</span>]
                                  [<span class="s">&quot;Label&quot;</span> a]
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;BACKTRACK&quot;</span>]
                                  [<span class="s">&quot;Target&quot;</span> b]
                                  <span class="nc">~</span>x
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;LIST_APPEND&quot;</span>]
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;COMMIT&quot;</span>]
                                  [<span class="s">&quot;Target&quot;</span> a]
                                  [<span class="s">&quot;Label&quot;</span> b]
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;LIST_END&quot;</span>]]
  Not           <span class="nb">=</span> ast<span class="nb">:</span>x       <span class="nb">-&gt;</span> label()<span class="nb">:</span>a <span class="nb">-&gt;</span> label()<span class="nb">:</span>b
                              <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;BACKTRACK&quot;</span>]
                                  [<span class="s">&quot;Target&quot;</span> b]
                                  <span class="nc">~</span>x
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;COMMIT&quot;</span>]
                                  [<span class="s">&quot;Target&quot;</span> a]
                                  [<span class="s">&quot;Label&quot;</span> a]
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;FAIL&quot;</span>]
                                  [<span class="s">&quot;Value&quot;</span> <span class="s">&quot;no match&quot;</span>]
                                  [<span class="s">&quot;Label&quot;</span> b]]
  MatchCallRule <span class="nb">=</span>             <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;MATCH_CALL_RULE&quot;</span>]]
  MatchRule     <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x         <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;CALL&quot;</span>]
                                  [<span class="s">&quot;Target&quot;</span> x]]
  MatchObject   <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x         <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;MATCH&quot;</span>]
                                  x]
  MatchList     <span class="nb">=</span> ast<span class="nb">:</span>x       <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;PUSH_STREAM&quot;</span>]
                                  <span class="nc">~</span>x
                                  [<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;POP_STREAM&quot;</span>]]
  Action        <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x         <span class="nb">-&gt;</span> [[<span class="s">&quot;OpCode&quot;</span> <span class="s">&quot;ACTION&quot;</span>]
                                  [<span class="s">&quot;Action&quot;</span> x]]
  asts          <span class="nb">=</span> ast<span class="nc">*</span><span class="nb">:</span>xs <span class="nc">!.</span>  <span class="nb">-&gt;</span> xs
  ast           <span class="nb">=</span> [<span class="nc">%</span><span class="nb">:</span>x]       <span class="nb">-&gt;</span> x
}
</pre>
</div>
<div class="highlight">
<pre><span></span>Assembler {
  Grammar  <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x ast<span class="nc">*</span><span class="nb">:</span>ys     <span class="nb">-&gt;</span> list()<span class="nb">:</span>rules
                             <span class="nb">-&gt;</span> list()<span class="nb">:</span>code
                             <span class="nb">-&gt;</span> dict()<span class="nb">:</span>labels
                             <span class="nb">-&gt;</span> list()<span class="nb">:</span>patches
                             <span class="nb">-&gt;</span> ys
                             <span class="nb">-&gt;</span> run(<span class="s">&quot;asts&quot;</span> patches)
                             <span class="nb">-&gt;</span> { <span class="s">&quot;class &quot;</span> x <span class="s">&quot;(Grammar):</span><span class="se">\n</span><span class="s">&quot;</span> &gt;
                                    <span class="s">&quot;rules = {</span><span class="se">\n</span><span class="s">&quot;</span> &gt; join(rules <span class="s">&quot;,</span><span class="se">\n</span><span class="s">&quot;</span>) &lt; <span class="s">&quot;</span><span class="se">\n</span><span class="s">}</span><span class="se">\n</span><span class="s">&quot;</span>
                                    <span class="s">&quot;code = [</span><span class="se">\n</span><span class="s">&quot;</span> &gt; join(code  <span class="s">&quot;,</span><span class="se">\n</span><span class="s">&quot;</span>) &lt; <span class="s">&quot;</span><span class="se">\n</span><span class="s">]</span><span class="se">\n</span><span class="s">&quot;</span>
                                  &lt; }
  Rule     <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x             <span class="nb">-&gt;</span> add(rules { repr(x) <span class="s">&quot;: &quot;</span> len(code) })
                             <span class="nb">-&gt;</span> set(labels x len(code))
  Label    <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x             <span class="nb">-&gt;</span> set(labels x len(code))
  Target   <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x             <span class="nb">-&gt;</span> add(patches [<span class="s">&quot;Patch&quot;</span> len(code) x])
                             <span class="nb">-&gt;</span> add(code <span class="s">&quot;placeholder&quot;</span>)
  Patch    <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x <span class="nc">.</span><span class="nb">:</span>y         <span class="nb">-&gt;</span> set(code x get(labels y))
  OpCode   <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x             <span class="nb">-&gt;</span> add(code x)
  Value    <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x             <span class="nb">-&gt;</span> add(code repr(x))
  Eq       <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x             <span class="nb">-&gt;</span> add(code repr(x))
                             <span class="nb">-&gt;</span> add(code { <span class="s">&quot;lambda x: x == &quot;</span> repr(x) })
  Range    <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x <span class="nc">.</span><span class="nb">:</span>y         <span class="nb">-&gt;</span> add(code repr({<span class="s">&quot;range &quot;</span> repr(x) <span class="s">&quot;-&quot;</span> repr(y)}))
                             <span class="nb">-&gt;</span> add(code { <span class="s">&quot;lambda x: &quot;</span> repr(x) <span class="s">&quot; &lt;= x &lt;= &quot;</span> repr(y) })
  Any      <span class="nb">=</span>                 <span class="nb">-&gt;</span> add(code repr(<span class="s">&quot;any&quot;</span>))
                             <span class="nb">-&gt;</span> add(code <span class="s">&quot;lambda x: True&quot;</span>)
  Action   <span class="nb">=</span> ast<span class="nb">:</span>x           <span class="nb">-&gt;</span> add(code {<span class="s">&quot;lambda self: &quot;</span> x})
  Set      <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x ast<span class="nb">:</span>y ast<span class="nb">:</span>z <span class="nb">-&gt;</span> { <span class="s">&quot;self.bind(&quot;</span> repr(x) <span class="s">&quot;, &quot;</span> y <span class="s">&quot;, lambda: &quot;</span> z <span class="s">&quot;)&quot;</span> }
  String   <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x             <span class="nb">-&gt;</span> repr(x)
  List     <span class="nb">=</span> astList<span class="nb">:</span>x       <span class="nb">-&gt;</span> { <span class="s">&quot;concat([&quot;</span> x <span class="s">&quot;])&quot;</span> }
  ListItem <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x ast<span class="nb">:</span>y       <span class="nb">-&gt;</span> { <span class="s">&quot;splice(&quot;</span> repr(x) <span class="s">&quot;, &quot;</span> y <span class="s">&quot;)&quot;</span> }
  Format   <span class="nb">=</span> astList<span class="nb">:</span>x       <span class="nb">-&gt;</span> { <span class="s">&quot;join([&quot;</span> x <span class="s">&quot;])&quot;</span> }
  Indent   <span class="nb">=</span> ast<span class="nb">:</span>x           <span class="nb">-&gt;</span> { <span class="s">&quot;indent(&quot;</span> x <span class="s">&quot;, &quot;</span>
                                  <span class="s">&quot;self.lookup(&#39;indentprefix&#39;))&quot;</span> }
  Call     <span class="nb">=</span> ast<span class="nb">:</span>x astList<span class="nb">:</span>y <span class="nb">-&gt;</span> { x <span class="s">&quot;(&quot;</span> y <span class="s">&quot;)&quot;</span> }
  Lookup   <span class="nb">=</span> <span class="nc">.</span><span class="nb">:</span>x             <span class="nb">-&gt;</span> { <span class="s">&quot;self.lookup(&quot;</span> repr(x) <span class="s">&quot;)&quot;</span> }
  asts     <span class="nb">=</span> ast<span class="nc">*</span><span class="nb">:</span>xs <span class="nc">!.</span>      <span class="nb">-&gt;</span> { xs }
  astList  <span class="nb">=</span> ast<span class="nc">*</span><span class="nb">:</span>xs         <span class="nb">-&gt;</span> join(xs <span class="s">&quot;, &quot;</span>)
  ast      <span class="nb">=</span> [<span class="nc">%</span><span class="nb">:</span>x]           <span class="nb">-&gt;</span> x
}
</pre>
</div>
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">VM</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">rules</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_rule</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">SemanticAction</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">[</span><span class="n">start_rule</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call_backtrack_stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_rest</span> <span class="o">=</span> <span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_rest</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope_rest</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latest_fail_message</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_fail_pos</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">pop_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pc</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">code</span>

<span class="k">def</span> <span class="nf">PUSH_SCOPE</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span> <span class="o">=</span> <span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span><span class="p">)</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">def</span> <span class="nf">POP_SCOPE</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span>

<span class="k">def</span> <span class="nf">BACKTRACK</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">call_backtrack_stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">(),</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream_rest</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span>
    <span class="p">))</span>

<span class="k">def</span> <span class="nf">COMMIT</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">call_backtrack_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">CALL</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">CALL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">CALL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">pc</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span><span class="o">+</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">,))</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">vm</span><span class="o">.</span><span class="n">memo</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vm</span><span class="o">.</span><span class="n">memo</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">FAIL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">memo</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vm</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream_rest</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">memo</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">call_backtrack_stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vm</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">pc</span>

<span class="k">def</span> <span class="nf">RETURN</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">vm</span><span class="o">.</span><span class="n">call_backtrack_stack</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vm</span><span class="o">.</span><span class="n">action</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">call_backtrack_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">memo</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream_rest</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">MATCH</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">object_description</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">()</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">()</span>
    <span class="n">MATCH_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;expected </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">object_description</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">MATCH_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">fn</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">]):</span>
        <span class="n">FAIL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">SemanticAction</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">MATCH_CALL_RULE</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">MATCH_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vm</span><span class="o">.</span><span class="n">rules</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;expected rule name&quot;</span><span class="p">,))</span>
    <span class="n">CALL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">rules</span><span class="p">[</span><span class="n">vm</span><span class="o">.</span><span class="n">action</span><span class="o">.</span><span class="n">value</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">LIST_START</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span> <span class="o">=</span> <span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span><span class="p">)</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">LIST_APPEND</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">LIST_END</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">SemanticAction</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">])</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span>

<span class="k">def</span> <span class="nf">BIND</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">[</span><span class="n">vm</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">()]</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">action</span>

<span class="k">def</span> <span class="nf">ACTION</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">vm</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">SemanticAction</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">PUSH_STREAM</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">FAIL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;expected list&quot;</span><span class="p">,))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">stream_rest</span> <span class="o">=</span> <span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream_rest</span><span class="p">)</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span> <span class="o">+</span> <span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">,)</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">POP_STREAM</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">):</span>
        <span class="n">FAIL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;expected end of list&quot;</span><span class="p">,))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream_rest</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream_rest</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">FAIL</span><span class="p">(</span><span class="n">vm</span><span class="p">):</span>
    <span class="n">FAIL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">pop_arg</span><span class="p">(),))</span>

<span class="k">def</span> <span class="nf">FAIL_</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">fail_message</span><span class="p">):</span>
    <span class="n">fail_pos</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span><span class="o">+</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">,)</span>
    <span class="k">if</span> <span class="n">fail_pos</span> <span class="o">&gt;=</span> <span class="n">vm</span><span class="o">.</span><span class="n">latest_fail_pos</span><span class="p">:</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">latest_fail_message</span> <span class="o">=</span> <span class="n">fail_message</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">latest_fail_pos</span> <span class="o">=</span> <span class="n">fail_pos</span>
    <span class="n">call_backtrack_entry</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">vm</span><span class="o">.</span><span class="n">call_backtrack_stack</span><span class="p">:</span>
        <span class="n">call_backtrack_entry</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">call_backtrack_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">call_backtrack_entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vm</span><span class="o">.</span><span class="n">memo</span><span class="p">[</span><span class="n">call_backtrack_entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">fail_message</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">call_backtrack_entry</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MatchError</span><span class="p">(</span>
            <span class="n">vm</span><span class="o">.</span><span class="n">latest_fail_message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">vm</span><span class="o">.</span><span class="n">latest_fail_message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span>
            <span class="n">vm</span><span class="o">.</span><span class="n">latest_fail_pos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">vm</span><span class="o">.</span><span class="n">stream</span>
        <span class="p">)</span>
    <span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">stream_rest</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">pos_rest</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">scope_rest</span><span class="p">)</span> <span class="o">=</span> <span class="n">call_backtrack_entry</span>

<span class="k">class</span> <span class="nc">SemanticAction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span>

    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">=</span> <span class="n">runtime</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">continuation</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">continuation</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">MatchError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="ne">Exception</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span>

<span class="k">class</span> <span class="nc">Grammar</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="p">{}):</span>
        <span class="k">return</span> <span class="n">Runtime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">runtime</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span>
            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">Counter</span><span class="p">(),</span>
            <span class="s2">&quot;indentprefix&quot;</span><span class="p">:</span> <span class="s2">&quot;    &quot;</span><span class="p">,</span>
            <span class="s2">&quot;list&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
            <span class="s2">&quot;dict&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
            <span class="s2">&quot;add&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
            <span class="s2">&quot;get&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">],</span>
            <span class="s2">&quot;set&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span>
            <span class="s2">&quot;len&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">,</span>
            <span class="s2">&quot;repr&quot;</span><span class="p">:</span> <span class="nb">repr</span><span class="p">,</span>
            <span class="s2">&quot;join&quot;</span><span class="p">:</span> <span class="n">join</span><span class="p">,</span>
        <span class="p">}))</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Runtime</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grammar</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="nb">dict</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span> <span class="o">=</span> <span class="n">grammar</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Runtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">}))</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">VM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Counter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">splice</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">concat</span><span class="p">([</span><span class="n">splice</span><span class="p">(</span><span class="n">depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">subitem</span><span class="p">)</span> <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">item</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="n">lists</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">lists</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">join</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">indent</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;    &quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">compile_chain</span><span class="p">(</span><span class="n">grammars</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="kn">import</span> <span class="nn">pprint</span>
    <span class="k">for</span> <span class="n">grammar</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">grammars</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">grammar</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">MatchError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">MARKER</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[0;31m&lt;ERROR POSITION&gt;</span><span class="se">\033</span><span class="s2">[0m&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">stream_string</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">stream</span><span class="p">[:</span><span class="n">e</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">+</span> <span class="n">MARKER</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">pos</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stream_string</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">stream</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;ERROR: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">POSITION: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">STREAM:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
                <span class="n">e</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span>
                <span class="n">indent</span><span class="p">(</span><span class="n">stream_string</span><span class="p">)</span>
            <span class="p">))</span>
    <span class="k">return</span> <span class="n">source</span>
</pre>
</div>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="ow">or</span> <span class="p">[</span><span class="s2">&quot;--compile&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;--support&quot;</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">SUPPORT</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;--copy&quot;</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">read</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;--embed&quot;</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                <span class="nb">repr</span><span class="p">(</span><span class="n">read</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
            <span class="p">))</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;--compile&quot;</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">compile_chain</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">Parser</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">CodeGenerator</span><span class="p">,</span> <span class="s2">&quot;asts&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">Assembler</span><span class="p">,</span> <span class="s2">&quot;asts&quot;</span><span class="p">)],</span>
                <span class="n">read</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;ERROR: Unknown command &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">command</span><span class="p">))</span>
</pre>
</div>
<p>–</p>
<p>CHANGES:</p>
<p>It started with this goal:</p>
<pre><code>RLMeta Poster 2: Experiment with PyVM and see if it can improve &quot;assembly
code in code generator&quot;.</code></pre>
<p>Then continued with this:</p>
<ul>
<li><p>Import all current code into smart notes document.</p>
<ul>
<li>Added search of code notes to smart notes.</li>
</ul></li>
<li><p>Adapt to Python 3.</p></li>
<li><p>PyVM (first version)</p>
<ul>
<li><p>Split PyVM into parser and codegenerator.</p></li>
<li><p>Two passes (and thus two grammars) are needed if macros should be possible to define last.</p></li>
<li><p>What is a good AST for PyVM?</p></li>
</ul>
<p>[x] Continue to build parse tree.</p>
<p>[x] Figure out how to replace support library in make.py</p>
<p>$ wc -l rlmeta/<em>; echo; wc -l pyvm/</em> 66 rlmeta/codegenerator.rlmeta 46 rlmeta/main.py 58 rlmeta/parser.rlmeta 77 rlmeta/support.py 169 rlmeta/vm.pyvm 416 total</p>
<pre><code>22 pyvm/codegenerator.rlmeta
19 pyvm/parser.rlmeta
35 pyvm/support.py
76 total</code></pre></li>
</ul>
<p>[x] Better error message than None if runtime/scope is not found.</p>
<pre><code>* Rename match -&gt; matches in Scope
* Immutable scope instead and fail if entry does not exist?

$ wc -l rlmeta/*; echo; wc -l pyvm/*
   66 rlmeta/codegenerator.rlmeta
   46 rlmeta/main.py
   58 rlmeta/parser.rlmeta
   68 rlmeta/support.py
  169 rlmeta/vm.pyvm
  407 total

  22 pyvm/codegenerator.rlmeta
  19 pyvm/parser.rlmeta
  35 pyvm/support.py
  76 total</code></pre>
<p>[x] Generate instruction “enum” so that strings don’t have to be used</p>
<p>[x] Counter class is more clean</p>
<pre><code>$ wc -l rlmeta/*; echo; wc -l pyvm/*
   66 rlmeta/codegenerator.rlmeta
   46 rlmeta/main.py
   58 rlmeta/parser.rlmeta
   72 rlmeta/support.py
  169 rlmeta/vm.pyvm
  411 total

  22 pyvm/codegenerator.rlmeta
  19 pyvm/parser.rlmeta
  35 pyvm/support.py
  76 total</code></pre>
<ul>
<li>No need to wrap parser output in list for codegenerator in RLMeta</li>
</ul>
<p>[x] Put compile + error reporting function in support lib.</p>
<p>[x] No need to wrap parser output in list for codegenerator in PyVM</p>
<p>[x] You can put any crap at end of file, and parsers don’t care. Fix it!</p>
<p>[x] VM should not know about runtime.</p>
<p>[x] Move “assembly” out of support library. Grammar should generate labels/instructions.</p>
<p>[x] No failure if VM-compilation fails? (Swap Instruction arguments.)</p>
<p>[x] Support recursive macros?</p>
<pre><code>* Probably requires function to run grammar against an object.

* Needed to get rid of duplicated call code.</code></pre>
<p>[x] Split code generator into code generator and python assembler. That makes each phase more clear and allows for optimizations.</p>
<p>[x] Better AST for action expressions.</p>
<p>[x] Can “native” calls be removed by adding binding in runtime?</p>
<p>[x] Resolve labels in assembler.</p>
<p>[x] Get rid of PyVM</p>
<pre><code>[x] Compilation was further complicated now when VM has to be generated and
    a combined support library created.

[x] Clean up PyVM grammars

[x] Write VM as clean as possible in Python. Then write a separate
    optimized VM?</code></pre>
<p>[x] Put object match expr tree in parser instead of in codegen?</p>
<pre><code>- This makes the VM more clean. There is only one instruction for matching
  and the matching is done with a Python lambda. The VM knows nothing about
  how to match a single object.</code></pre>
<p>TODO:</p>
<p>[ ] Can support library (and new Runtime) become smaller?</p>
<p>[ ] Should memo be removed since it is an optimization?</p>
<p>[ ] VM</p>
<pre><code>[ ] Review VM and see if clarity can be improved.

    [ ] Can it be written with less optimizations in mind?

[ ] Can fail_pos be handled better?

[ ] MatchError probably has wrong stream if error occurs deep down

[ ] I am not happy with how the new VM looks. A mix between classes and
    functions and helpers.</code></pre>
<p>[ ] Add DEBUG flag that outputs source between passes.</p>
<p>[ ] Why not better error message when action wrong? Why index wrong?</p>
<pre><code>  Action        = .:xs
  Action        = .*:xs

[ ] Wrong pos is reported for &quot;Not&quot; instruction.

-   &quot;Not&quot; messes up latest_fail_pos in general. It should perhaps be
    disabled during a &quot;Not&quot;?</code></pre>
<p>[ ] Poster with intermediate versions shown.</p>
<pre><code>* Interactive on the web. (Requires JS version.)</code></pre>
<p>[ ] Try to port to JS to see how flexible it is?</p>
<p>[ ] Rename ast to tree?</p>
<p>[ ] Lists can be repeated and xs refers to last match?</p>
<pre><code>echo &#39;G{x=[.:xs]*}&#39; | python rlmeta.py</code></pre>
<p>[ ] Lookup concat/splice/join/indent?</p>
]]></summary>
</entry>
<entry>
    <title>DRAFT: Compiling expressions to x86 machine code</title>
    <link href="http://rickardlindberg.me/writing/expr-to-x86-compiler/" />
    <id>http://rickardlindberg.me/writing/expr-to-x86-compiler/</id>
    <published>2020-05-20T00:00:00Z</published>
    <updated>2020-05-20T00:00:00Z</updated>
    <summary type="html"><![CDATA[<h1>DRAFT: Compiling expressions to x86 machine code</h1>

<p><em>Published on 2020-05-20.</em></p>

<strong>This is a work in progress that will change. Like to see it finished? Let me know by sending me an email.</strong>

<p>In <a href="/writing/rlmeta-left-associativity/index.html">Parsing left associative operators using RLMeta</a> we looked at how to parse a subset of mathematical expressions. In this article we will take it further and compile such expressions to x86 machine code. Thus creating a real compiler for expressions.</p>

<ul><li><a href="#969c195716e94c05ad23bd50f7dc061a">Overview</a>

</li>

<li><a href="#a83adf407dbd43929bfbb4ab7f7311e5">Parser</a>

</li>

<li><a href="#0488143f851349bf876169b04770e6bf">Abstract code generator</a>

</li>

<li><a href="#bb76bbbba48d4c23b982e5c90af36d86">X86 code generator</a>

</li>

<li><a href="#12e4e39c6b494b30a425f4570e8b8d53">GAS generator</a>

</li>

<li><a href="#d3ece5a4ba484033ac47d9190e513acd">Assembler</a>

</li>

<li><a href="#a047c1b417bc42799170c0e3632cc3f9">Appendix: All source code</a>

</li>

<li><a href="#ff74bacb76bf40f082f88738ebc5d8b0">Appendix: RLMeta</a>

</li>

<li><a href="#7790eca23f484ea7b7430ef607b491c2">Appendix: Test script</a>

</li>

</ul><h2><a name="969c195716e94c05ad23bd50f7dc061a"></a>Overview</h2>

<p>The compiler is implemented by transforming an expression in different stages.</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">-</span><span class="">&gt;</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">g</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">-</span><span class="">&gt;</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">g</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">-</span><span class="">&gt;</span><span class=""> </span><span class="">G</span><span class="">A</span><span class="">S</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">-</span><span class="">&gt;</span><span class=""> </span><span class="">A</span><span class="">s</span><span class="">s</span><span class="">e</span><span class="">m</span><span class="">b</span><span class="">l</span><span class="">e</span><span class="">r</span><span class="">
</span></pre></div>

</div>

<p>The parser turns an expression into an AST, which the abstract code generator turns it into instructions for an imaginary stack machine, which the X86 code generator turns into assembly instructions for the x86 architecture. The final stage either turns those instructions into textual assembly instructions suitable for compilation with the GNU assembler (GAS) or assembles them straight into machine code.</p>

<p>The style of this article is inspired by <a href="http://www.vpri.org/pdf/m2009011_chns_mng.pdf">Chains of meaning in the STEPS system</a> (<a href="http://rickardlindberg.me/writing/alan-kay-notes/m2009011_chns_mng.pdf">mirror</a>) where a compiler is explained by explaining all stages in it. Examples are shown throughout what the input and output of the different stages are.</p>

<h2><a name="a83adf407dbd43929bfbb4ab7f7311e5"></a>Parser</h2>

<p>The parser is the same as in the previous article. It turns an expression into an AST:</p>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>parser.rlmeta</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">d</span><span class="">i</span><span class="">g</span><span class="">i</span><span class="">t</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class="">(</span><span class="">o</span><span class="">p</span><span class="nb">:</span><span class="">y</span><span class=""> </span><span class="">d</span><span class="">i</span><span class="">g</span><span class="">i</span><span class="">t</span><span class="nb">:</span><span class="">z</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">y</span><span class=""> </span><span class="">z</span><span class="">]</span><span class="">)</span><span class="nc">*</span><span class="nb">:</span><span class="">x</span><span class="">s</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">p</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">O</span><span class="">p</span><span class="">s</span><span class="">(</span><span class="">x</span><span class=""> </span><span class="">x</span><span class="">s</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">d</span><span class="">i</span><span class="">g</span><span class="">i</span><span class="">t</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="sc">'</span><span class="sc">0</span><span class="sc">'</span><span class="nc">-</span><span class="sc">'</span><span class="sc">9</span><span class="sc">'</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">i</span><span class="">n</span><span class="">t</span><span class="">(</span><span class="">x</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">o</span><span class="">p</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">+</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">A</span><span class="s">D</span><span class="s">D</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">1</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">e</span><span class="s">f</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">-</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">S</span><span class="s">U</span><span class="s">B</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">1</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">e</span><span class="s">f</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">*</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">M</span><span class="s">U</span><span class="s">L</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">2</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">e</span><span class="s">f</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">/</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">D</span><span class="s">I</span><span class="s">V</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">2</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">e</span><span class="s">f</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">^</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">P</span><span class="s">O</span><span class="s">W</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">3</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">i</span><span class="s">g</span><span class="s">h</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<p>The support functions are also defined similarly:</p>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">compiler</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">O</span><span class="nc">p</span><span class="p">(</span><span class="nb">o</span><span class="nb">b</span><span class="nb">j</span><span class="nb">e</span><span class="nb">c</span><span class="nb">t</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="fm">_</span><span class="fm">_</span><span class="fm">i</span><span class="fm">n</span><span class="fm">i</span><span class="fm">t</span><span class="fm">_</span><span class="fm">_</span><span class="p">(</span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="p">,</span><span class=""> </span><span class="n">f</span><span class="n">n</span><span class="p">,</span><span class=""> </span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class="p">,</span><span class=""> </span><span class="n">a</span><span class="n">s</span><span class="n">s</span><span class="n">o</span><span class="n">c</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="o">.</span><span class="n">f</span><span class="n">n</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">f</span><span class="n">n</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="o">.</span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="o">.</span><span class="n">a</span><span class="n">s</span><span class="n">s</span><span class="n">o</span><span class="n">c</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">a</span><span class="n">s</span><span class="n">s</span><span class="n">o</span><span class="n">c</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">compiler</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">m</span><span class="nf">a</span><span class="nf">k</span><span class="nf">e</span><span class="nf">A</span><span class="nf">s</span><span class="nf">t</span><span class="nf">N</span><span class="nf">o</span><span class="nf">d</span><span class="nf">e</span><span class="p">(</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">o</span><span class="nf">p</span><span class="p">(</span><span class="n">l</span><span class="n">e</span><span class="n">f</span><span class="n">t</span><span class="p">,</span><span class=""> </span><span class="n">r</span><span class="n">i</span><span class="n">g</span><span class="n">h</span><span class="n">t</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="p">[</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">,</span><span class=""> </span><span class="n">l</span><span class="n">e</span><span class="n">f</span><span class="n">t</span><span class="p">,</span><span class=""> </span><span class="n">r</span><span class="n">i</span><span class="n">g</span><span class="n">h</span><span class="n">t</span><span class="p">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">compiler</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">p</span><span class="nf">a</span><span class="nf">r</span><span class="nf">s</span><span class="nf">e</span><span class="nf">O</span><span class="nf">p</span><span class="nf">s</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class="p">,</span><span class=""> </span><span class="n">m</span><span class="n">i</span><span class="n">n</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">w</span><span class="k">h</span><span class="k">i</span><span class="k">l</span><span class="k">e</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class=""> </span><span class="ow">a</span><span class="ow">n</span><span class="ow">d</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class=""> </span><span class="o">&gt;</span><span class="o">=</span><span class=""> </span><span class="n">m</span><span class="n">i</span><span class="n">n</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="p">,</span><span class=""> </span><span class="n">r</span><span class="n">h</span><span class="n">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class="o">.</span><span class="n">p</span><span class="n">o</span><span class="n">p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">i</span><span class="k">f</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="o">.</span><span class="n">a</span><span class="n">s</span><span class="n">s</span><span class="n">o</span><span class="n">c</span><span class=""> </span><span class="o">=</span><span class="o">=</span><span class=""> </span><span class="s2">"</span><span class="s2">l</span><span class="s2">e</span><span class="s2">f</span><span class="s2">t</span><span class="s2">"</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">n</span><span class="n">e</span><span class="n">x</span><span class="n">t</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="o">.</span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">e</span><span class="k">l</span><span class="k">s</span><span class="k">e</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">n</span><span class="n">e</span><span class="n">x</span><span class="n">t</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="o">.</span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="o">.</span><span class="n">f</span><span class="n">n</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">p</span><span class="n">a</span><span class="n">r</span><span class="n">s</span><span class="n">e</span><span class="n">O</span><span class="n">p</span><span class="n">s</span><span class="p">(</span><span class="n">r</span><span class="n">h</span><span class="n">s</span><span class="p">,</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class="p">,</span><span class=""> </span><span class="n">n</span><span class="n">e</span><span class="n">x</span><span class="n">t</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class="p">)</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="">
</span></pre></div>

</div>

<p>Parsing the simple expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>Parsing the slightly more complicated expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<h2><a name="0488143f851349bf876169b04770e6bf"></a>Abstract code generator</h2>

<p>The abstract code generator turns an AST into instructions for an imaginary stack machine:</p>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>abstractcodegen.rlmeta</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">[</span><span class="nc">.</span><span class="nb">:</span><span class="">n</span><span class="">a</span><span class="">m</span><span class="">e</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="nb">:</span><span class="">l</span><span class="">e</span><span class="">f</span><span class="">t</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="nb">:</span><span class="">r</span><span class="">i</span><span class="">g</span><span class="">h</span><span class="">t</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="nc">~</span><span class="">r</span><span class="">i</span><span class="">g</span><span class="">h</span><span class="">t</span><span class=""> </span><span class="nc">~</span><span class="">l</span><span class="">e</span><span class="">f</span><span class="">t</span><span class=""> </span><span class="">n</span><span class="">a</span><span class="">m</span><span class="">e</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">l</span><span class="">e</span><span class="">a</span><span class="">f</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">P</span><span class="s">U</span><span class="s">S</span><span class="s">H</span><span class="s">"</span><span class=""> </span><span class="">l</span><span class="">e</span><span class="">a</span><span class="">f</span><span class="">]</span><span class="">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<p>The right hand side of an expression is generated before the left hand side. This order does not matter, but it turns out that it's a bit easier to generate x86 instructions if the right hand side comes first.</p>

<p>Generating stack machine instructions for the simple expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<p>Generating stack machine instructions for the slightly more complicated expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<h2><a name="bb76bbbba48d4c23b982e5c90af36d86"></a>X86 code generator</h2>

<p>The X86 code generator turns instructions for the imaginary stack machine into assembly instructions for the x86 architecture.</p>

<p>An assembly instruction is represented as a list with its mnemonic and operands:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">[</span><span class="">"</span><span class="">m</span><span class="">n</span><span class="">e</span><span class="">m</span><span class="">o</span><span class="">n</span><span class="">i</span><span class="">c</span><span class="">"</span><span class=""> </span><span class="">o</span><span class="">p</span><span class="">1</span><span class=""> </span><span class="">o</span><span class="">p</span><span class="">2</span><span class=""> </span><span class="">.</span><span class="">.</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<p>For an instruction performing a binary operation, <code>op1</code> is the destination and <code>op2</code> is the source. The binary operation performed is therefore the following:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">o</span><span class="">p</span><span class="">1</span><span class=""> </span><span class="">=</span><span class=""> </span><span class="">o</span><span class="">p</span><span class="">1</span><span class=""> </span><span class="">`</span><span class="">o</span><span class="">p</span><span class="">e</span><span class="">r</span><span class="">a</span><span class="">t</span><span class="">i</span><span class="">o</span><span class="">n</span><span class="">`</span><span class=""> </span><span class="">o</span><span class="">p</span><span class="">2</span><span class="">
</span></pre></div>

</div>

<p>An operand can be either a constant, a register, or a memory location.</p>

<ul><li><code>rdi</code> is the stack pointer where the stack grows downwards (64-bit integer)</li>

<li><code>eax</code> is a TOS (top of stack) register (32-bit signed integer)</li>

<li>We are generating a function according to x64 calling conventions.</li>

</ul>

<p><strong>TODO: explain what registers and so on that we use</strong></p>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>x86codegen.rlmeta</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="nc">%</span><span class="nc">*</span><span class="nb">:</span><span class="">x</span><span class="">s</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="nc">~</span><span class="nc">~</span><span class="">x</span><span class="">s</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">t</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="cp"> </span><span class="cp"> </span><span class="cp">&lt;</span><span class="cp">&lt;</span><span class="cp">i</span><span class="cp">n</span><span class="cp">s</span><span class="cp">t</span><span class="cp">r</span><span class="cp">u</span><span class="cp">c</span><span class="cp">t</span><span class="cp">i</span><span class="cp">o</span><span class="cp">n</span><span class="cp">s</span><span class="cp">&gt;</span><span class="cp">&gt;</span><span class="cp">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>x86codegen.rlmeta</li><li><span class="cp">instructions</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">A</span><span class="">D</span><span class="">D</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>x86codegen.rlmeta</li><li><span class="cp">instructions</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">S</span><span class="">U</span><span class="">B</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>x86codegen.rlmeta</li><li><span class="cp">instructions</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">M</span><span class="">U</span><span class="">L</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">i</span><span class="s">m</span><span class="s">u</span><span class="s">l</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>x86codegen.rlmeta</li><li><span class="cp">instructions</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">D</span><span class="">I</span><span class="">V</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">d</span><span class="s">q</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">i</span><span class="s">d</span><span class="s">i</span><span class="s">v</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">o</span><span class="s">n</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>x86codegen.rlmeta</li><li><span class="cp">instructions</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">P</span><span class="">O</span><span class="">W</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>x86codegen.rlmeta</li><li><span class="cp">instructions</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">m</span><span class="s">o</span><span class="s">v</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">m</span><span class="s">o</span><span class="s">v</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">x</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<p>Generating assembly instructions for the simple expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<p>Generating assembly instructions for the slightly more complicated expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">1</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">
</span></pre></div>

</div>

<h2><a name="12e4e39c6b494b30a425f4570e8b8d53"></a>GAS generator</h2>

<p>The GAS generator turns assembly instructions into textual assembly instructions suitable for compilation with the GNU assembler (GAS): <code>gcc -nostdlib file.s</code>:</p>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>gas.rlmeta</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">G</span><span class="">a</span><span class="">s</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="">i</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="nc">*</span><span class="nb">:</span><span class="">x</span><span class="">s</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">.</span><span class="s">g</span><span class="s">l</span><span class="s">o</span><span class="s">b</span><span class="s">a</span><span class="s">l</span><span class="s"> </span><span class="s">e</span><span class="s">x</span><span class="s">p</span><span class="s">r</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">x</span><span class="s">p</span><span class="s">r</span><span class="s">:</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">x</span><span class="">s</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">i</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">r</span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">[</span><span class="">m</span><span class="">n</span><span class="">e</span><span class="">m</span><span class="">o</span><span class="">n</span><span class="">i</span><span class="">c</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class="">o</span><span class="">p</span><span class="nb">:</span><span class="">t</span><span class="">a</span><span class="">r</span><span class="">g</span><span class="">e</span><span class="">t</span><span class=""> </span><span class="">o</span><span class="">p</span><span class="nb">:</span><span class="">s</span><span class="">o</span><span class="">u</span><span class="">r</span><span class="">c</span><span class="">e</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">{</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="s">"</span><span class="s"> </span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="">s</span><span class="">o</span><span class="">u</span><span class="">r</span><span class="">c</span><span class="">e</span><span class=""> </span><span class="s">"</span><span class="s">,</span><span class="s">"</span><span class=""> </span><span class="">t</span><span class="">a</span><span class="">r</span><span class="">g</span><span class="">e</span><span class="">t</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class=""> </span><span class="">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">[</span><span class="">m</span><span class="">n</span><span class="">e</span><span class="">m</span><span class="">o</span><span class="">n</span><span class="">i</span><span class="">c</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class="">o</span><span class="">p</span><span class="nb">:</span><span class="">a</span><span class="">r</span><span class="">g</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">{</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="s">"</span><span class="s"> </span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="">a</span><span class="">r</span><span class="">g</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class=""> </span><span class="">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">[</span><span class="">m</span><span class="">n</span><span class="">e</span><span class="">m</span><span class="">o</span><span class="">n</span><span class="">i</span><span class="">c</span><span class="nb">:</span><span class="">x</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">{</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class=""> </span><span class="">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">o</span><span class="">p</span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">n</span><span class="">a</span><span class="">m</span><span class="">e</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">{</span><span class=""> </span><span class="s">"</span><span class="s">%</span><span class="s">"</span><span class=""> </span><span class="">n</span><span class="">a</span><span class="">m</span><span class="">e</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">n</span><span class="">a</span><span class="">m</span><span class="">e</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">{</span><span class=""> </span><span class="s">"</span><span class="s">(</span><span class="s">%</span><span class="s">"</span><span class=""> </span><span class="">n</span><span class="">a</span><span class="">m</span><span class="">e</span><span class=""> </span><span class="s">"</span><span class="s">)</span><span class="s">"</span><span class=""> </span><span class="">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">v</span><span class="">a</span><span class="">l</span><span class="">u</span><span class="">e</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">{</span><span class=""> </span><span class="s">"</span><span class="s">$</span><span class="s">"</span><span class=""> </span><span class="">v</span><span class="">a</span><span class="">l</span><span class="">u</span><span class="">e</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">m</span><span class="">n</span><span class="">e</span><span class="">m</span><span class="">o</span><span class="">n</span><span class="">i</span><span class="">c</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class="">s</span><span class="">i</span><span class="">z</span><span class="">e</span><span class="nb">:</span><span class="">y</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">p</span><span class="">a</span><span class="">d</span><span class="">(</span><span class="">x</span><span class=""> </span><span class="">y</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">s</span><span class="">i</span><span class="">z</span><span class="">e</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">o</span><span class="s">n</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">"</span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="s">"</span><span class="s">"</span><span class="">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">p</span><span class="nf">a</span><span class="nf">d</span><span class="p">(</span><span class="n">t</span><span class="n">e</span><span class="n">x</span><span class="n">t</span><span class="p">,</span><span class=""> </span><span class="n">s</span><span class="n">u</span><span class="n">f</span><span class="n">f</span><span class="n">i</span><span class="n">x</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="p">(</span><span class="n">t</span><span class="n">e</span><span class="n">x</span><span class="n">t</span><span class="o">+</span><span class="n">s</span><span class="n">u</span><span class="n">f</span><span class="n">f</span><span class="n">i</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="n">j</span><span class="n">u</span><span class="n">s</span><span class="n">t</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>driver.c</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">s</span><span class="cpf">t</span><span class="cpf">d</span><span class="cpf">l</span><span class="cpf">i</span><span class="cpf">b</span><span class="cpf">.</span><span class="cpf">h</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">s</span><span class="cpf">t</span><span class="cpf">d</span><span class="cpf">i</span><span class="cpf">o</span><span class="cpf">.</span><span class="cpf">h</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="">
</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="nf">e</span><span class="nf">x</span><span class="nf">p</span><span class="nf">r</span><span class="p">(</span><span class="kt">v</span><span class="kt">o</span><span class="kt">i</span><span class="kt">d</span><span class="o">*</span><span class=""> </span><span class="n">m</span><span class="n">e</span><span class="n">m</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class="">
</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="nf">m</span><span class="nf">a</span><span class="nf">i</span><span class="nf">n</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="kt">v</span><span class="kt">o</span><span class="kt">i</span><span class="kt">d</span><span class="o">*</span><span class=""> </span><span class="n">m</span><span class="n">e</span><span class="n">m</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="p">(</span><span class="kt">v</span><span class="kt">o</span><span class="kt">i</span><span class="kt">d</span><span class="o">*</span><span class="p">)</span><span class="n">m</span><span class="n">a</span><span class="n">l</span><span class="n">l</span><span class="n">o</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="mi">2</span><span class="o">*</span><span class="k">s</span><span class="k">i</span><span class="k">z</span><span class="k">e</span><span class="k">o</span><span class="k">f</span><span class="p">(</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class="p">)</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">u</span><span class="n">l</span><span class="n">t</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">(</span><span class="n">m</span><span class="n">e</span><span class="n">m</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">p</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">f</span><span class="p">(</span><span class="s">"</span><span class="s">%</span><span class="s">d</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">,</span><span class=""> </span><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">u</span><span class="n">l</span><span class="n">t</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class="p">}</span><span class="">
</span></pre></div>

</div>

<p>Generating GAS instructions (and compiling and running them) for the simple expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">G</span><span class="">a</span><span class="">s</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">.</span><span class="">g</span><span class="">l</span><span class="">o</span><span class="">b</span><span class="">a</span><span class="">l</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">
</span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">:</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">3</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">G</span><span class="">c</span><span class="">c</span><span class="">C</span><span class="">o</span><span class="">m</span><span class="">p</span><span class="">i</span><span class="">l</span><span class="">e</span><span class="">A</span><span class="">n</span><span class="">d</span><span class="">R</span><span class="">u</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>Generating GAS instructions (and compiling and running them) for the slightly more complicated expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">1</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">G</span><span class="">a</span><span class="">s</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">.</span><span class="">g</span><span class="">l</span><span class="">o</span><span class="">b</span><span class="">a</span><span class="">l</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">
</span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">:</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">3</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">2</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">1</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">G</span><span class="">c</span><span class="">c</span><span class="">C</span><span class="">o</span><span class="">m</span><span class="">p</span><span class="">i</span><span class="">l</span><span class="">e</span><span class="">A</span><span class="">n</span><span class="">d</span><span class="">R</span><span class="">u</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">7</span><span class="">
</span></pre></div>

</div>

<p>Generating GAS instructions (and compiling and running them) for the expression that uses all operators</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">2</span><span class="">^</span><span class="">4</span><span class="">/</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">-</span><span class="">4</span><span class="">+</span><span class="">5</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">2</span><span class="">^</span><span class="">4</span><span class="">/</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">-</span><span class="">4</span><span class="">+</span><span class="">5</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">S</span><span class="">U</span><span class="">B</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">D</span><span class="">I</span><span class="">V</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">O</span><span class="">W</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">5</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">5</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">O</span><span class="">W</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">D</span><span class="">I</span><span class="">V</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">S</span><span class="">U</span><span class="">B</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">5</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">d</span><span class="">q</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">i</span><span class="">d</span><span class="">i</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">'</span><span class="">l</span><span class="">o</span><span class="">n</span><span class="">g</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">G</span><span class="">a</span><span class="">s</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">.</span><span class="">g</span><span class="">l</span><span class="">o</span><span class="">b</span><span class="">a</span><span class="">l</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">
</span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">:</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">5</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">3</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">2</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">,</span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">2</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">c</span><span class="">d</span><span class="">q</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">
</span><span class="">i</span><span class="">d</span><span class="">i</span><span class="">v</span><span class="">l</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">
</span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">(</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">)</span><span class="">,</span><span class="">%</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">
</span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">$</span><span class="">4</span><span class="">,</span><span class="">%</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">
</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">G</span><span class="">c</span><span class="">c</span><span class="">C</span><span class="">o</span><span class="">m</span><span class="">p</span><span class="">i</span><span class="">l</span><span class="">e</span><span class="">A</span><span class="">n</span><span class="">d</span><span class="">R</span><span class="">u</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">1</span><span class="">
</span></pre></div>

</div>

<h2><a name="d3ece5a4ba484033ac47d9190e513acd"></a>Assembler</h2>

<p>The assembler turns assembly instructions into machine code:</p>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>assembler.rlmeta</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">A</span><span class="">s</span><span class="">s</span><span class="">e</span><span class="">m</span><span class="">b</span><span class="">l</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="">i</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="nc">*</span><span class="nb">:</span><span class="">x</span><span class="">s</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="nc">~</span><span class="nc">~</span><span class="">x</span><span class="">s</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">i</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">r</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="nc">%</span><span class="nb">:</span><span class="">x</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">x</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="nb">:</span><span class="">i</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">0</span><span class="">x</span><span class="">4</span><span class="">8</span><span class=""> </span><span class="">0</span><span class="">x</span><span class="">8</span><span class="">3</span><span class=""> </span><span class="">m</span><span class="">o</span><span class="">d</span><span class="">R</span><span class="">m</span><span class="">D</span><span class="">i</span><span class="">r</span><span class="">e</span><span class="">c</span><span class="">t</span><span class="">(</span><span class="">r</span><span class="">)</span><span class=""> </span><span class="nc">~</span><span class="">l</span><span class="">i</span><span class="">t</span><span class="">t</span><span class="">l</span><span class="">e</span><span class="">E</span><span class="">n</span><span class="">d</span><span class="">i</span><span class="">a</span><span class="">n</span><span class="">(</span><span class="">i</span><span class=""> </span><span class="">1</span><span class="">)</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="nb">:</span><span class="">i</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">c</span><span class="">d</span><span class="">q</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">i</span><span class="">d</span><span class="">i</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">o</span><span class="s">n</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">0</span><span class="">x</span><span class="">8</span><span class="">9</span><span class=""> </span><span class="">m</span><span class="">o</span><span class="">d</span><span class="">R</span><span class="">m</span><span class="">A</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">(</span><span class="">m</span><span class=""> </span><span class="">r</span><span class="">)</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="nb">:</span><span class="">i</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">(</span><span class="">0</span><span class="">x</span><span class="">b</span><span class="">8</span><span class=""> </span><span class="">r</span><span class="">)</span><span class=""> </span><span class="nc">~</span><span class="">l</span><span class="">i</span><span class="">t</span><span class="">t</span><span class="">l</span><span class="">e</span><span class="">E</span><span class="">n</span><span class="">d</span><span class="">i</span><span class="">a</span><span class="">n</span><span class="">(</span><span class="">i</span><span class=""> </span><span class="">4</span><span class="">)</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">t</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">0</span><span class="">x</span><span class="">c</span><span class="">3</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="">n</span><span class="nb">:</span><span class="">n</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">n</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="">n</span><span class="nb">:</span><span class="">n</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">n</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="">n</span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">7</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="">n</span><span class="nb">:</span><span class="">n</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">n</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="">n</span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">0</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">i</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">i</span><span class="">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">compiler</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">m</span><span class="nf">o</span><span class="nf">d</span><span class="nf">R</span><span class="nf">m</span><span class="nf">D</span><span class="nf">i</span><span class="nf">r</span><span class="nf">e</span><span class="nf">c</span><span class="nf">t</span><span class="p">(</span><span class="n">r</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="mh">0</span><span class="mh">x</span><span class="mh">c</span><span class="mh">0</span><span class=""> </span><span class="o">|</span><span class=""> </span><span class="n">r</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">compiler</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">m</span><span class="nf">o</span><span class="nf">d</span><span class="nf">R</span><span class="nf">m</span><span class="nf">A</span><span class="nf">d</span><span class="nf">d</span><span class="nf">r</span><span class="p">(</span><span class="n">a</span><span class="n">d</span><span class="n">d</span><span class="n">r</span><span class="n">R</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">d</span><span class="n">e</span><span class="n">s</span><span class="n">i</span><span class="n">n</span><span class="n">a</span><span class="n">t</span><span class="n">i</span><span class="n">o</span><span class="n">n</span><span class="n">R</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="mh">0</span><span class="mh">x</span><span class="mh">0</span><span class="mh">0</span><span class=""> </span><span class="o">|</span><span class=""> </span><span class="p">(</span><span class="n">d</span><span class="n">e</span><span class="n">s</span><span class="n">i</span><span class="n">n</span><span class="n">a</span><span class="n">t</span><span class="n">i</span><span class="n">o</span><span class="n">n</span><span class="n">R</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="mi">3</span><span class="p">)</span><span class=""> </span><span class="o">|</span><span class=""> </span><span class="n">a</span><span class="n">d</span><span class="n">d</span><span class="n">r</span><span class="n">R</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">compiler</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">a</span><span class="nf">d</span><span class="nf">d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class=""> </span><span class="n">y</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">x</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="n">y</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">compiler</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">l</span><span class="nf">i</span><span class="nf">t</span><span class="nf">t</span><span class="nf">l</span><span class="nf">e</span><span class="nf">E</span><span class="nf">n</span><span class="nf">d</span><span class="nf">i</span><span class="nf">a</span><span class="nf">n</span><span class="p">(</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">B</span><span class="n">y</span><span class="n">t</span><span class="n">e</span><span class="n">s</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">i</span><span class="k">f</span><span class=""> </span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&lt;</span><span class=""> </span><span class="mi">0</span><span class=""> </span><span class="ow">o</span><span class="ow">r</span><span class=""> </span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&gt;</span><span class="o">=</span><span class=""> </span><span class="mi">2</span><span class="o">*</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">B</span><span class="n">y</span><span class="n">t</span><span class="n">e</span><span class="n">s</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">a</span><span class="k">i</span><span class="k">s</span><span class="k">e</span><span class=""> </span><span class="ne">V</span><span class="ne">a</span><span class="ne">l</span><span class="ne">u</span><span class="ne">e</span><span class="ne">E</span><span class="ne">r</span><span class="ne">r</span><span class="ne">o</span><span class="ne">r</span><span class="p">(</span><span class="s2">"</span><span class="s2">{</span><span class="s2">}</span><span class="s2"> </span><span class="s2">i</span><span class="s2">s</span><span class="s2"> </span><span class="s2">n</span><span class="s2">o</span><span class="s2">t</span><span class="s2"> </span><span class="s2">i</span><span class="s2">n</span><span class="s2"> </span><span class="s2">r</span><span class="s2">a</span><span class="s2">n</span><span class="s2">g</span><span class="s2">e</span><span class="s2"> </span><span class="s2">[</span><span class="s2">0</span><span class="s2">,</span><span class="s2"> </span><span class="s2">m</span><span class="s2">a</span><span class="s2">x</span><span class="s2">]</span><span class="s2">"</span><span class="o">.</span><span class="n">f</span><span class="n">o</span><span class="n">r</span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="p">(</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="n">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="p">[</span><span class="p">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">f</span><span class="k">o</span><span class="k">r</span><span class=""> </span><span class="n">i</span><span class=""> </span><span class="ow">i</span><span class="ow">n</span><span class=""> </span><span class="nb">r</span><span class="nb">a</span><span class="nb">n</span><span class="nb">g</span><span class="nb">e</span><span class="p">(</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">B</span><span class="n">y</span><span class="n">t</span><span class="n">e</span><span class="n">s</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">a</span><span class="n">p</span><span class="n">p</span><span class="n">e</span><span class="n">n</span><span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&amp;</span><span class=""> </span><span class="mh">0</span><span class="mh">x</span><span class="mh">f</span><span class="mh">f</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&gt;</span><span class="o">&gt;</span><span class="o">=</span><span class=""> </span><span class="mi">8</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="n">s</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">run machine code</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="kn">i</span><span class="kn">m</span><span class="kn">p</span><span class="kn">o</span><span class="kn">r</span><span class="kn">t</span><span class=""> </span><span class="nn">c</span><span class="nn">t</span><span class="nn">y</span><span class="nn">p</span><span class="nn">e</span><span class="nn">s</span><span class="">
</span><span class="kn">i</span><span class="kn">m</span><span class="kn">p</span><span class="kn">o</span><span class="kn">r</span><span class="kn">t</span><span class=""> </span><span class="nn">m</span><span class="nn">m</span><span class="nn">a</span><span class="nn">p</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">run machine code</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="n">l</span><span class="n">i</span><span class="n">b</span><span class="n">c</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">d</span><span class="n">l</span><span class="n">l</span><span class="o">.</span><span class="n">L</span><span class="n">o</span><span class="n">a</span><span class="n">d</span><span class="n">L</span><span class="n">i</span><span class="n">b</span><span class="n">r</span><span class="n">a</span><span class="n">r</span><span class="n">y</span><span class="p">(</span><span class="bp">N</span><span class="bp">o</span><span class="bp">n</span><span class="bp">e</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">run machine code</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">l</span><span class="n">i</span><span class="n">b</span><span class="n">c</span><span class="o">.</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="">
</span><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="o">.</span><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">v</span><span class="n">o</span><span class="n">i</span><span class="n">d</span><span class="n">_</span><span class="n">p</span><span class="">
</span><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="o">.</span><span class="n">a</span><span class="n">r</span><span class="n">g</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="p">(</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">v</span><span class="n">o</span><span class="n">i</span><span class="n">d</span><span class="n">_</span><span class="n">p</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">s</span><span class="n">i</span><span class="n">z</span><span class="n">e</span><span class="n">_</span><span class="n">t</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">s</span><span class="n">i</span><span class="n">z</span><span class="n">e</span><span class="n">_</span><span class="n">t</span><span class="p">,</span><span class="">
</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">run machine code</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="s2">"</span><span class="s2">"</span><span class="o">.</span><span class="n">j</span><span class="n">o</span><span class="n">i</span><span class="n">n</span><span class="p">(</span><span class="p">[</span><span class="nb">c</span><span class="nb">h</span><span class="nb">r</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class=""> </span><span class="k">f</span><span class="k">o</span><span class="k">r</span><span class=""> </span><span class="n">x</span><span class=""> </span><span class="ow">i</span><span class="ow">n</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">c</span><span class="n">h</span><span class="n">i</span><span class="n">n</span><span class="n">e</span><span class="n">_</span><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="p">]</span><span class="p">)</span><span class="">
</span><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="n">_</span><span class="n">a</span><span class="n">d</span><span class="n">d</span><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="p">(</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="bp">N</span><span class="bp">o</span><span class="bp">n</span><span class="bp">e</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">l</span><span class="nb">e</span><span class="nb">n</span><span class="p">(</span><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="p">)</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="o">.</span><span class="n">P</span><span class="n">R</span><span class="n">O</span><span class="n">T</span><span class="n">_</span><span class="n">R</span><span class="n">E</span><span class="n">A</span><span class="n">D</span><span class="o">|</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="o">.</span><span class="n">P</span><span class="n">R</span><span class="n">O</span><span class="n">T</span><span class="n">_</span><span class="n">W</span><span class="n">R</span><span class="n">I</span><span class="n">T</span><span class="n">E</span><span class="o">|</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="o">.</span><span class="n">P</span><span class="n">R</span><span class="n">O</span><span class="n">T</span><span class="n">_</span><span class="n">E</span><span class="n">X</span><span class="n">E</span><span class="n">C</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="o">.</span><span class="n">M</span><span class="n">A</span><span class="n">P</span><span class="n">_</span><span class="n">P</span><span class="n">R</span><span class="n">I</span><span class="n">V</span><span class="n">A</span><span class="n">T</span><span class="n">E</span><span class="o">|</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="o">.</span><span class="n">M</span><span class="n">A</span><span class="n">P</span><span class="n">_</span><span class="n">A</span><span class="n">N</span><span class="n">O</span><span class="n">N</span><span class="n">Y</span><span class="n">M</span><span class="n">O</span><span class="n">U</span><span class="n">S</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="mi">0</span><span class="">
</span><span class="p">)</span><span class="">
</span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">m</span><span class="n">e</span><span class="n">m</span><span class="n">m</span><span class="n">o</span><span class="n">v</span><span class="n">e</span><span class="p">(</span><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="n">_</span><span class="n">a</span><span class="n">d</span><span class="n">d</span><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">s</span><span class="p">,</span><span class=""> </span><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="p">,</span><span class=""> </span><span class="nb">l</span><span class="nb">e</span><span class="nb">n</span><span class="p">(</span><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="p">)</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">run machine code</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">m</span><span class="n">a</span><span class="n">l</span><span class="n">l</span><span class="n">o</span><span class="n">c</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">l</span><span class="n">i</span><span class="n">b</span><span class="n">c</span><span class="o">.</span><span class="n">m</span><span class="n">a</span><span class="n">l</span><span class="n">l</span><span class="n">o</span><span class="n">c</span><span class="">
</span><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">m</span><span class="n">a</span><span class="n">l</span><span class="n">l</span><span class="n">o</span><span class="n">c</span><span class="o">.</span><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">v</span><span class="n">o</span><span class="n">i</span><span class="n">d</span><span class="n">_</span><span class="n">p</span><span class="">
</span><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">m</span><span class="n">a</span><span class="n">l</span><span class="n">l</span><span class="n">o</span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="n">r</span><span class="n">g</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="p">(</span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">s</span><span class="n">i</span><span class="n">z</span><span class="n">e</span><span class="n">_</span><span class="n">t</span><span class="p">,</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">run machine code</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="n">_</span><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">C</span><span class="n">F</span><span class="n">U</span><span class="n">N</span><span class="n">C</span><span class="n">T</span><span class="n">Y</span><span class="n">P</span><span class="n">E</span><span class="p">(</span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="p">,</span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">_</span><span class="n">v</span><span class="n">o</span><span class="n">i</span><span class="n">d</span><span class="n">_</span><span class="n">p</span><span class="p">)</span><span class="">
</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="n">_</span><span class="n">f</span><span class="n">n</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">c</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="n">a</span><span class="n">s</span><span class="n">t</span><span class="p">(</span><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="n">_</span><span class="n">a</span><span class="n">d</span><span class="n">d</span><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">s</span><span class="p">,</span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="n">_</span><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">t</span><span class="n">y</span><span class="n">p</span><span class="n">e</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li><li><span class="cp">run machine code</span>

</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">u</span><span class="n">l</span><span class="n">t</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="n">_</span><span class="n">f</span><span class="n">n</span><span class="p">(</span><span class="n">f</span><span class="n">n</span><span class="n">_</span><span class="n">m</span><span class="n">a</span><span class="n">l</span><span class="n">l</span><span class="n">o</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="mi">0</span><span class="mi">2</span><span class="mi">4</span><span class="p">)</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<p>Generating machine code (and running it) for the simple expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">s</span><span class="">s</span><span class="">e</span><span class="">m</span><span class="">b</span><span class="">l</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">5</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">R</span><span class="">u</span><span class="">n</span><span class="">n</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>Generating machine code (and running it) for the slightly more complicated expression</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">1</span><span class="">+</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">1</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">s</span><span class="">s</span><span class="">e</span><span class="">m</span><span class="">b</span><span class="">l</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">5</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">R</span><span class="">u</span><span class="">n</span><span class="">n</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">1</span><span class="">
</span></pre></div>

</div>

<p>Generating machine code (and running it) for the expression that uses all operators</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">2</span><span class="">^</span><span class="">4</span><span class="">/</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">-</span><span class="">4</span><span class="">+</span><span class="">5</span><span class="">
</span></pre></div>

</div>

<p>looks like this:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">2</span><span class="">^</span><span class="">4</span><span class="">/</span><span class="">2</span><span class="">*</span><span class="">3</span><span class="">-</span><span class="">4</span><span class="">+</span><span class="">5</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">S</span><span class="">U</span><span class="">B</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">D</span><span class="">I</span><span class="">V</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">O</span><span class="">W</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">5</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">5</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">P</span><span class="">O</span><span class="">W</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">D</span><span class="">I</span><span class="">V</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">M</span><span class="">U</span><span class="">L</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">S</span><span class="">U</span><span class="">B</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">'</span><span class="">A</span><span class="">D</span><span class="">D</span><span class="">'</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">5</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">3</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">m</span><span class="">o</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">2</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">d</span><span class="">q</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">i</span><span class="">d</span><span class="">i</span><span class="">v</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">'</span><span class="">l</span><span class="">o</span><span class="">n</span><span class="">g</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">e</span><span class="">a</span><span class="">x</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">s</span><span class="">u</span><span class="">b</span><span class="">'</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">'</span><span class="">r</span><span class="">d</span><span class="">i</span><span class="">'</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">'</span><span class="">,</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">[</span><span class="">'</span><span class="">r</span><span class="">e</span><span class="">t</span><span class="">'</span><span class="">]</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">A</span><span class="">s</span><span class="">s</span><span class="">e</span><span class="">m</span><span class="">b</span><span class="">l</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">[</span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">5</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">3</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">1</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">9</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">3</span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">7</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">8</span><span class="">4</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">2</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">0</span><span class="">,</span><span class="">
</span><span class=""> </span><span class="">1</span><span class="">9</span><span class="">5</span><span class="">]</span><span class="">
</span><span class="">
</span><span class="">=</span><span class="">V</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class=""> </span><span class="">X</span><span class="">8</span><span class="">6</span><span class="">R</span><span class="">u</span><span class="">n</span><span class="">n</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">=</span><span class="">
</span><span class="">
</span><span class="">2</span><span class="">
</span></pre></div>

</div>

<h2><a name="a047c1b417bc42799170c0e3632cc3f9"></a>Appendix: All source code</h2>

<p>Here is all source code needed to turn expressions into x86 machine code. Code to run machine code is dependent on situation, so it is not included here.</p>

<p>Parser:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">P</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">d</span><span class="">i</span><span class="">g</span><span class="">i</span><span class="">t</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class="">(</span><span class="">o</span><span class="">p</span><span class="nb">:</span><span class="">y</span><span class=""> </span><span class="">d</span><span class="">i</span><span class="">g</span><span class="">i</span><span class="">t</span><span class="nb">:</span><span class="">z</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">y</span><span class=""> </span><span class="">z</span><span class="">]</span><span class="">)</span><span class="nc">*</span><span class="nb">:</span><span class="">x</span><span class="">s</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">p</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">O</span><span class="">p</span><span class="">s</span><span class="">(</span><span class="">x</span><span class=""> </span><span class="">x</span><span class="">s</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">d</span><span class="">i</span><span class="">g</span><span class="">i</span><span class="">t</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="sc">'</span><span class="sc">0</span><span class="sc">'</span><span class="nc">-</span><span class="sc">'</span><span class="sc">9</span><span class="sc">'</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">i</span><span class="">n</span><span class="">t</span><span class="">(</span><span class="">x</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">o</span><span class="">p</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">+</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">A</span><span class="s">D</span><span class="s">D</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">1</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">e</span><span class="s">f</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">-</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">S</span><span class="s">U</span><span class="s">B</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">1</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">e</span><span class="s">f</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">*</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">M</span><span class="s">U</span><span class="s">L</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">2</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">e</span><span class="s">f</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">/</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">D</span><span class="s">I</span><span class="s">V</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">2</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">e</span><span class="s">f</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="sc">'</span><span class="sc">^</span><span class="sc">'</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">O</span><span class="">p</span><span class="">(</span><span class="">m</span><span class="">a</span><span class="">k</span><span class="">e</span><span class="">A</span><span class="">s</span><span class="">t</span><span class="">N</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">(</span><span class="s">"</span><span class="s">P</span><span class="s">O</span><span class="s">W</span><span class="s">"</span><span class="">)</span><span class=""> </span><span class="">3</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">i</span><span class="s">g</span><span class="s">h</span><span class="s">t</span><span class="s">"</span><span class="">)</span><span class="">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<p>Abstract code generator:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">A</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">[</span><span class="nc">.</span><span class="nb">:</span><span class="">n</span><span class="">a</span><span class="">m</span><span class="">e</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="nb">:</span><span class="">l</span><span class="">e</span><span class="">f</span><span class="">t</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="nb">:</span><span class="">r</span><span class="">i</span><span class="">g</span><span class="">h</span><span class="">t</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="nc">~</span><span class="">r</span><span class="">i</span><span class="">g</span><span class="">h</span><span class="">t</span><span class=""> </span><span class="nc">~</span><span class="">l</span><span class="">e</span><span class="">f</span><span class="">t</span><span class=""> </span><span class="">n</span><span class="">a</span><span class="">m</span><span class="">e</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">l</span><span class="">e</span><span class="">a</span><span class="">f</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">P</span><span class="s">U</span><span class="s">S</span><span class="s">H</span><span class="s">"</span><span class=""> </span><span class="">l</span><span class="">e</span><span class="">a</span><span class="">f</span><span class="">]</span><span class="">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<p>X86 code generator:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">X</span><span class="">8</span><span class="">6</span><span class="">C</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">G</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="nc">%</span><span class="nc">*</span><span class="nb">:</span><span class="">x</span><span class="">s</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="nc">~</span><span class="nc">~</span><span class="">x</span><span class="">s</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">t</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">A</span><span class="">D</span><span class="">D</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">S</span><span class="">U</span><span class="">B</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">M</span><span class="">U</span><span class="">L</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">i</span><span class="s">m</span><span class="s">u</span><span class="s">l</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">D</span><span class="">I</span><span class="">V</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">d</span><span class="s">q</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">i</span><span class="s">d</span><span class="s">i</span><span class="s">v</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">o</span><span class="s">n</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">s</span><span class="s">u</span><span class="s">b</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">P</span><span class="">O</span><span class="">W</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">P</span><span class="">U</span><span class="">S</span><span class="">H</span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">x</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">4</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">m</span><span class="s">o</span><span class="s">v</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">m</span><span class="s">o</span><span class="s">v</span><span class="s">"</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class="">]</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="">x</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">]</span><span class="">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<p>Assembler:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="">A</span><span class="">s</span><span class="">s</span><span class="">e</span><span class="">m</span><span class="">b</span><span class="">l</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="">i</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="nc">*</span><span class="nb">:</span><span class="">x</span><span class="">s</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="nc">~</span><span class="nc">~</span><span class="">x</span><span class="">s</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">i</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="">r</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="nc">%</span><span class="nb">:</span><span class="">x</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">x</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="nb">:</span><span class="">i</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">0</span><span class="">x</span><span class="">4</span><span class="">8</span><span class=""> </span><span class="">0</span><span class="">x</span><span class="">8</span><span class="">3</span><span class=""> </span><span class="">m</span><span class="">o</span><span class="">d</span><span class="">R</span><span class="">m</span><span class="">D</span><span class="">i</span><span class="">r</span><span class="">e</span><span class="">c</span><span class="">t</span><span class="">(</span><span class="">r</span><span class="">)</span><span class=""> </span><span class="nc">~</span><span class="">l</span><span class="">i</span><span class="">t</span><span class="">t</span><span class="">l</span><span class="">e</span><span class="">E</span><span class="">n</span><span class="">d</span><span class="">i</span><span class="">a</span><span class="">n</span><span class="">(</span><span class="">i</span><span class=""> </span><span class="">1</span><span class="">)</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">s</span><span class="">u</span><span class="">b</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="nb">:</span><span class="">i</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">i</span><span class="">m</span><span class="">u</span><span class="">l</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">c</span><span class="">d</span><span class="">q</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">i</span><span class="">d</span><span class="">i</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="s">"</span><span class="s">l</span><span class="s">o</span><span class="s">n</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">m</span><span class="">o</span><span class="">v</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="nb">:</span><span class="">m</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">0</span><span class="">x</span><span class="">8</span><span class="">9</span><span class=""> </span><span class="">m</span><span class="">o</span><span class="">d</span><span class="">R</span><span class="">m</span><span class="">A</span><span class="">d</span><span class="">d</span><span class="">r</span><span class="">(</span><span class="">m</span><span class=""> </span><span class="">r</span><span class="">)</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="nb">:</span><span class="">r</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class="nb">:</span><span class="">i</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">(</span><span class="">0</span><span class="">x</span><span class="">b</span><span class="">8</span><span class=""> </span><span class="">r</span><span class="">)</span><span class=""> </span><span class="nc">~</span><span class="">l</span><span class="">i</span><span class="">t</span><span class="">t</span><span class="">l</span><span class="">e</span><span class="">E</span><span class="">n</span><span class="">d</span><span class="">i</span><span class="">a</span><span class="">n</span><span class="">(</span><span class="">i</span><span class=""> </span><span class="">4</span><span class="">)</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">t</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">[</span><span class="">0</span><span class="">x</span><span class="">c</span><span class="">3</span><span class="">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">a</span><span class="">d</span><span class="">d</span><span class="">r</span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">a</span><span class="s">d</span><span class="s">d</span><span class="s">r</span><span class="s">"</span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="">n</span><span class="nb">:</span><span class="">n</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">n</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="">n</span><span class="nb">:</span><span class="">n</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">n</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">6</span><span class="">4</span><span class="">n</span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="s">"</span><span class="s">r</span><span class="s">d</span><span class="s">i</span><span class="s">"</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">7</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">r</span><span class="s">e</span><span class="s">g</span><span class="s">"</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="">n</span><span class="nb">:</span><span class="">n</span><span class="">]</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">n</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">r</span><span class="">e</span><span class="">g</span><span class="">3</span><span class="">2</span><span class="">n</span><span class=""> </span><span class="nb">=</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">|</span><span class=""> </span><span class="s">"</span><span class="s">e</span><span class="s">a</span><span class="s">x</span><span class="s">"</span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">0</span><span class="">
</span><span class=""> </span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">n</span><span class="">s</span><span class="">t</span><span class=""> </span><span class=""> </span><span class="nb">=</span><span class=""> </span><span class="">[</span><span class="s">"</span><span class="s">c</span><span class="s">o</span><span class="s">n</span><span class="s">s</span><span class="s">t</span><span class="s">"</span><span class=""> </span><span class="nc">.</span><span class="nb">:</span><span class="">i</span><span class="">]</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">-</span><span class="nb">&gt;</span><span class=""> </span><span class="">i</span><span class="">
</span><span class="">}</span><span class="">
</span></pre></div>

</div>

<p>Support functions:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">O</span><span class="nc">p</span><span class="p">(</span><span class="nb">o</span><span class="nb">b</span><span class="nb">j</span><span class="nb">e</span><span class="nb">c</span><span class="nb">t</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="fm">_</span><span class="fm">_</span><span class="fm">i</span><span class="fm">n</span><span class="fm">i</span><span class="fm">t</span><span class="fm">_</span><span class="fm">_</span><span class="p">(</span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="p">,</span><span class=""> </span><span class="n">f</span><span class="n">n</span><span class="p">,</span><span class=""> </span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class="p">,</span><span class=""> </span><span class="n">a</span><span class="n">s</span><span class="n">s</span><span class="n">o</span><span class="n">c</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="o">.</span><span class="n">f</span><span class="n">n</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">f</span><span class="n">n</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="o">.</span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="o">.</span><span class="n">a</span><span class="n">s</span><span class="n">s</span><span class="n">o</span><span class="n">c</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">a</span><span class="n">s</span><span class="n">s</span><span class="n">o</span><span class="n">c</span><span class="">
</span><span class="">
</span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">m</span><span class="nf">a</span><span class="nf">k</span><span class="nf">e</span><span class="nf">A</span><span class="nf">s</span><span class="nf">t</span><span class="nf">N</span><span class="nf">o</span><span class="nf">d</span><span class="nf">e</span><span class="p">(</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">o</span><span class="nf">p</span><span class="p">(</span><span class="n">l</span><span class="n">e</span><span class="n">f</span><span class="n">t</span><span class="p">,</span><span class=""> </span><span class="n">r</span><span class="n">i</span><span class="n">g</span><span class="n">h</span><span class="n">t</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="p">[</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">,</span><span class=""> </span><span class="n">l</span><span class="n">e</span><span class="n">f</span><span class="n">t</span><span class="p">,</span><span class=""> </span><span class="n">r</span><span class="n">i</span><span class="n">g</span><span class="n">h</span><span class="n">t</span><span class="p">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="">
</span><span class="">
</span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">p</span><span class="nf">a</span><span class="nf">r</span><span class="nf">s</span><span class="nf">e</span><span class="nf">O</span><span class="nf">p</span><span class="nf">s</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class="p">,</span><span class=""> </span><span class="n">m</span><span class="n">i</span><span class="n">n</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">w</span><span class="k">h</span><span class="k">i</span><span class="k">l</span><span class="k">e</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class=""> </span><span class="ow">a</span><span class="ow">n</span><span class="ow">d</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class=""> </span><span class="o">&gt;</span><span class="o">=</span><span class=""> </span><span class="n">m</span><span class="n">i</span><span class="n">n</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="p">,</span><span class=""> </span><span class="n">r</span><span class="n">h</span><span class="n">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class="o">.</span><span class="n">p</span><span class="n">o</span><span class="n">p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">i</span><span class="k">f</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="o">.</span><span class="n">a</span><span class="n">s</span><span class="n">s</span><span class="n">o</span><span class="n">c</span><span class=""> </span><span class="o">=</span><span class="o">=</span><span class=""> </span><span class="s2">"</span><span class="s2">l</span><span class="s2">e</span><span class="s2">f</span><span class="s2">t</span><span class="s2">"</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">n</span><span class="n">e</span><span class="n">x</span><span class="n">t</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="o">.</span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">e</span><span class="k">l</span><span class="k">s</span><span class="k">e</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">n</span><span class="n">e</span><span class="n">x</span><span class="n">t</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="o">.</span><span class="n">p</span><span class="n">r</span><span class="n">e</span><span class="n">c</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">o</span><span class="n">p</span><span class="o">.</span><span class="n">f</span><span class="n">n</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">p</span><span class="n">a</span><span class="n">r</span><span class="n">s</span><span class="n">e</span><span class="n">O</span><span class="n">p</span><span class="n">s</span><span class="p">(</span><span class="n">r</span><span class="n">h</span><span class="n">s</span><span class="p">,</span><span class=""> </span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="n">m</span><span class="n">s</span><span class="p">,</span><span class=""> </span><span class="n">n</span><span class="n">e</span><span class="n">x</span><span class="n">t</span><span class="n">_</span><span class="n">l</span><span class="n">e</span><span class="n">v</span><span class="n">e</span><span class="n">l</span><span class="p">)</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="">
</span><span class="">
</span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">m</span><span class="nf">o</span><span class="nf">d</span><span class="nf">R</span><span class="nf">m</span><span class="nf">D</span><span class="nf">i</span><span class="nf">r</span><span class="nf">e</span><span class="nf">c</span><span class="nf">t</span><span class="p">(</span><span class="n">r</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="mh">0</span><span class="mh">x</span><span class="mh">c</span><span class="mh">0</span><span class=""> </span><span class="o">|</span><span class=""> </span><span class="n">r</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="">
</span><span class="">
</span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">m</span><span class="nf">o</span><span class="nf">d</span><span class="nf">R</span><span class="nf">m</span><span class="nf">A</span><span class="nf">d</span><span class="nf">d</span><span class="nf">r</span><span class="p">(</span><span class="n">a</span><span class="n">d</span><span class="n">d</span><span class="n">r</span><span class="n">R</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">d</span><span class="n">e</span><span class="n">s</span><span class="n">i</span><span class="n">n</span><span class="n">a</span><span class="n">t</span><span class="n">i</span><span class="n">o</span><span class="n">n</span><span class="n">R</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="mh">0</span><span class="mh">x</span><span class="mh">0</span><span class="mh">0</span><span class=""> </span><span class="o">|</span><span class=""> </span><span class="p">(</span><span class="n">d</span><span class="n">e</span><span class="n">s</span><span class="n">i</span><span class="n">n</span><span class="n">a</span><span class="n">t</span><span class="n">i</span><span class="n">o</span><span class="n">n</span><span class="n">R</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="mi">3</span><span class="p">)</span><span class=""> </span><span class="o">|</span><span class=""> </span><span class="n">a</span><span class="n">d</span><span class="n">d</span><span class="n">r</span><span class="n">R</span><span class="n">e</span><span class="n">g</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="">
</span><span class="">
</span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">a</span><span class="nf">d</span><span class="nf">d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class=""> </span><span class="n">y</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">x</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="n">y</span><span class="">
</span><span class="">
</span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">l</span><span class="nf">i</span><span class="nf">t</span><span class="nf">t</span><span class="nf">l</span><span class="nf">e</span><span class="nf">E</span><span class="nf">n</span><span class="nf">d</span><span class="nf">i</span><span class="nf">a</span><span class="nf">n</span><span class="p">(</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">B</span><span class="n">y</span><span class="n">t</span><span class="n">e</span><span class="n">s</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">i</span><span class="k">f</span><span class=""> </span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&lt;</span><span class=""> </span><span class="mi">0</span><span class=""> </span><span class="ow">o</span><span class="ow">r</span><span class=""> </span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&gt;</span><span class="o">=</span><span class=""> </span><span class="mi">2</span><span class="o">*</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">B</span><span class="n">y</span><span class="n">t</span><span class="n">e</span><span class="n">s</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">a</span><span class="k">i</span><span class="k">s</span><span class="k">e</span><span class=""> </span><span class="ne">V</span><span class="ne">a</span><span class="ne">l</span><span class="ne">u</span><span class="ne">e</span><span class="ne">E</span><span class="ne">r</span><span class="ne">r</span><span class="ne">o</span><span class="ne">r</span><span class="p">(</span><span class="s2">"</span><span class="s2">{</span><span class="s2">}</span><span class="s2"> </span><span class="s2">i</span><span class="s2">s</span><span class="s2"> </span><span class="s2">n</span><span class="s2">o</span><span class="s2">t</span><span class="s2"> </span><span class="s2">i</span><span class="s2">n</span><span class="s2"> </span><span class="s2">r</span><span class="s2">a</span><span class="s2">n</span><span class="s2">g</span><span class="s2">e</span><span class="s2"> </span><span class="s2">[</span><span class="s2">0</span><span class="s2">,</span><span class="s2"> </span><span class="s2">m</span><span class="s2">a</span><span class="s2">x</span><span class="s2">]</span><span class="s2">"</span><span class="o">.</span><span class="n">f</span><span class="n">o</span><span class="n">r</span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="p">(</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="n">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="p">[</span><span class="p">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">f</span><span class="k">o</span><span class="k">r</span><span class=""> </span><span class="n">i</span><span class=""> </span><span class="ow">i</span><span class="ow">n</span><span class=""> </span><span class="nb">r</span><span class="nb">a</span><span class="nb">n</span><span class="nb">g</span><span class="nb">e</span><span class="p">(</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">B</span><span class="n">y</span><span class="n">t</span><span class="n">e</span><span class="n">s</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="n">s</span><span class="o">.</span><span class="n">a</span><span class="n">p</span><span class="n">p</span><span class="n">e</span><span class="n">n</span><span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&amp;</span><span class=""> </span><span class="mh">0</span><span class="mh">x</span><span class="mh">f</span><span class="mh">f</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">n</span><span class="n">u</span><span class="n">m</span><span class="n">b</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&gt;</span><span class="o">&gt;</span><span class="o">=</span><span class=""> </span><span class="mi">8</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="n">s</span><span class="">
</span></pre></div>

</div>

<h2><a name="ff74bacb76bf40f082f88738ebc5d8b0"></a>Appendix: RLMeta</h2>

<p>In this article I use a version of RLMeta that builds upon the VM based version from <a href="/writing/rlmeta-memoize-failures/index.html">memoizing failures</a>, but has the following changes:</p>

<ul><li>It supports integers in semantic actions.</li>

<li>It support arbitrary many <code>~</code> operators.</li>

<li>It supports repeating the <code>%</code> operator.</li>

</ul>

<p>I will not explain how I made those changes here. The full source code is available on <a href="https://github.com/rickardlindberg/rickardlindberg.me/tree/master/writing/expr-to-x86-compiler/rlmeta">GitHub</a>.</p>

<h2><a name="7790eca23f484ea7b7430ef607b491c2"></a>Appendix: Test script</h2>

<p>I used the following script to run the examples:</p>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>compile.sh</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="nb">s</span><span class="nb">e</span><span class="nb">t</span><span class=""> </span><span class="">-</span><span class="">e</span><span class="">
</span><span class="">
</span><span class="">c</span><span class="">o</span><span class="">m</span><span class="">p</span><span class="">i</span><span class="">l</span><span class="">e</span><span class="o">(</span><span class="o">)</span><span class=""> </span><span class="o">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">e</span><span class="nb">c</span><span class="nb">h</span><span class="nb">o</span><span class=""> </span><span class="s2">"</span><span class="s2">i</span><span class="s2">m</span><span class="s2">p</span><span class="s2">o</span><span class="s2">r</span><span class="s2">t</span><span class="s2"> </span><span class="s2">s</span><span class="s2">y</span><span class="s2">s</span><span class="s2">"</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">e</span><span class="nb">c</span><span class="nb">h</span><span class="nb">o</span><span class=""> </span><span class="s2">"</span><span class="s2">i</span><span class="s2">m</span><span class="s2">p</span><span class="s2">o</span><span class="s2">r</span><span class="s2">t</span><span class="s2"> </span><span class="s2">p</span><span class="s2">p</span><span class="s2">r</span><span class="s2">i</span><span class="s2">n</span><span class="s2">t</span><span class="s2">"</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">p</span><span class="">y</span><span class="">t</span><span class="">h</span><span class="">o</span><span class="">n</span><span class=""> </span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">/</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">.</span><span class="">p</span><span class="">y</span><span class=""> </span><span class="">-</span><span class="">-</span><span class="">s</span><span class="">u</span><span class="">p</span><span class="">p</span><span class="">o</span><span class="">r</span><span class="">t</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">c</span><span class="">a</span><span class="">t</span><span class=""> </span><span class="s2">"</span><span class="s2">s</span><span class="s2">u</span><span class="s2">p</span><span class="s2">p</span><span class="s2">o</span><span class="s2">r</span><span class="s2">t</span><span class="s2">.</span><span class="s2">p</span><span class="s2">y</span><span class="s2">"</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">p</span><span class="">y</span><span class="">t</span><span class="">h</span><span class="">o</span><span class="">n</span><span class=""> </span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">/</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">.</span><span class="">p</span><span class="">y</span><span class=""> </span><span class="">&lt;</span><span class=""> </span><span class="">p</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class="">.</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">p</span><span class="">y</span><span class="">t</span><span class="">h</span><span class="">o</span><span class="">n</span><span class=""> </span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">/</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">.</span><span class="">p</span><span class="">y</span><span class=""> </span><span class="">&lt;</span><span class=""> </span><span class="">a</span><span class="">b</span><span class="">s</span><span class="">t</span><span class="">r</span><span class="">a</span><span class="">c</span><span class="">t</span><span class="">c</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">g</span><span class="">e</span><span class="">n</span><span class="">.</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">p</span><span class="">y</span><span class="">t</span><span class="">h</span><span class="">o</span><span class="">n</span><span class=""> </span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">/</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">.</span><span class="">p</span><span class="">y</span><span class=""> </span><span class="">&lt;</span><span class=""> </span><span class="">x</span><span class="">8</span><span class="">6</span><span class="">c</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">g</span><span class="">e</span><span class="">n</span><span class="">.</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">p</span><span class="">y</span><span class="">t</span><span class="">h</span><span class="">o</span><span class="">n</span><span class=""> </span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">/</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">.</span><span class="">p</span><span class="">y</span><span class=""> </span><span class="">&lt;</span><span class=""> </span><span class="">g</span><span class="">a</span><span class="">s</span><span class="">.</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="">p</span><span class="">y</span><span class="">t</span><span class="">h</span><span class="">o</span><span class="">n</span><span class=""> </span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">/</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">.</span><span class="">p</span><span class="">y</span><span class=""> </span><span class="">&lt;</span><span class=""> </span><span class="">a</span><span class="">s</span><span class="">s</span><span class="">e</span><span class="">m</span><span class="">b</span><span class="">l</span><span class="">e</span><span class="">r</span><span class="">.</span><span class="">r</span><span class="">l</span><span class="">m</span><span class="">e</span><span class="">t</span><span class="">a</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="nb">e</span><span class="nb">c</span><span class="nb">h</span><span class="nb">o</span><span class=""> </span><span class="s2">"</span><span class="s2">m</span><span class="s2">a</span><span class="s2">i</span><span class="s2">n</span><span class="s2">(</span><span class="s2">)</span><span class="s2">"</span><span class="">
</span><span class="o">}</span><span class="">
</span><span class="">
</span><span class="">p</span><span class="">y</span><span class="">t</span><span class="">h</span><span class="">o</span><span class="">n</span><span class=""> </span><span class="">&lt;</span><span class="o">(</span><span class="">c</span><span class="">o</span><span class="">m</span><span class="">p</span><span class="">i</span><span class="">l</span><span class="">e</span><span class="o">)</span><span class=""> </span><span class="s2">"</span><span class="nv">$</span><span class="nv">@</span><span class="s2">"</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">m</span><span class="nf">a</span><span class="nf">i</span><span class="nf">n</span><span class="p">(</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class="n">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s2">"</span><span class="s2">p</span><span class="s2">a</span><span class="s2">r</span><span class="s2">s</span><span class="s2">e</span><span class="s2">r</span><span class="s2">"</span><span class="p">:</span><span class=""> </span><span class="n">P</span><span class="n">a</span><span class="n">r</span><span class="n">s</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="p">)</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s2">"</span><span class="s2">a</span><span class="s2">c</span><span class="s2">o</span><span class="s2">d</span><span class="s2">e</span><span class="s2">g</span><span class="s2">e</span><span class="s2">n</span><span class="s2">"</span><span class="p">:</span><span class=""> </span><span class="n">A</span><span class="n">b</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">a</span><span class="n">c</span><span class="n">t</span><span class="n">C</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="n">G</span><span class="n">e</span><span class="n">n</span><span class="p">(</span><span class="p">)</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s2">"</span><span class="s2">x</span><span class="s2">c</span><span class="s2">o</span><span class="s2">d</span><span class="s2">e</span><span class="s2">g</span><span class="s2">e</span><span class="s2">n</span><span class="s2">"</span><span class="p">:</span><span class=""> </span><span class="n">X</span><span class="n">8</span><span class="n">6</span><span class="n">C</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="n">G</span><span class="n">e</span><span class="n">n</span><span class="p">(</span><span class="p">)</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s2">"</span><span class="s2">g</span><span class="s2">a</span><span class="s2">s</span><span class="s2">"</span><span class="p">:</span><span class=""> </span><span class="n">G</span><span class="n">a</span><span class="n">s</span><span class="n">G</span><span class="n">e</span><span class="n">n</span><span class="p">(</span><span class="p">)</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s2">"</span><span class="s2">a</span><span class="s2">s</span><span class="s2">s</span><span class="s2">e</span><span class="s2">m</span><span class="s2">b</span><span class="s2">l</span><span class="s2">e</span><span class="s2">r</span><span class="s2">"</span><span class="p">:</span><span class=""> </span><span class="n">A</span><span class="n">s</span><span class="n">s</span><span class="n">e</span><span class="n">m</span><span class="n">b</span><span class="n">l</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="p">)</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="s2">"</span><span class="s2">x</span><span class="s2">r</span><span class="s2">u</span><span class="s2">n</span><span class="s2">n</span><span class="s2">e</span><span class="s2">r</span><span class="s2">"</span><span class="p">:</span><span class=""> </span><span class="n">X</span><span class="n">8</span><span class="n">6</span><span class="n">R</span><span class="n">u</span><span class="n">n</span><span class="n">n</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="p">)</span><span class="p">,</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">t</span><span class="k">r</span><span class="k">y</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">s</span><span class="n">y</span><span class="n">s</span><span class="o">.</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="n">i</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="n">e</span><span class="n">a</span><span class="n">d</span><span class="p">(</span><span class="p">)</span><span class="o">.</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">p</span><span class="p">(</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">f</span><span class="n">i</span><span class="n">r</span><span class="n">s</span><span class="n">t</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="bp">T</span><span class="bp">r</span><span class="bp">u</span><span class="bp">e</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">f</span><span class="k">o</span><span class="k">r</span><span class=""> </span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class="n">_</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class=""> </span><span class="ow">i</span><span class="ow">n</span><span class=""> </span><span class="n">s</span><span class="n">y</span><span class="n">s</span><span class="o">.</span><span class="n">a</span><span class="n">r</span><span class="n">g</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="p">]</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">i</span><span class="k">f</span><span class=""> </span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class="n">_</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="o">.</span><span class="n">s</span><span class="n">t</span><span class="n">a</span><span class="n">r</span><span class="n">t</span><span class="n">s</span><span class="n">w</span><span class="n">i</span><span class="n">t</span><span class="n">h</span><span class="p">(</span><span class="s2">"</span><span class="s2">@</span><span class="s2">"</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">w</span><span class="k">i</span><span class="k">t</span><span class="k">h</span><span class=""> </span><span class="nb">o</span><span class="nb">p</span><span class="nb">e</span><span class="nb">n</span><span class="p">(</span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class="n">_</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="p">]</span><span class="p">,</span><span class=""> </span><span class="s2">"</span><span class="s2">w</span><span class="s2">"</span><span class="p">)</span><span class=""> </span><span class="k">a</span><span class="k">s</span><span class=""> </span><span class="n">f</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">f</span><span class="o">.</span><span class="n">w</span><span class="n">r</span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="p">(</span><span class="nb">s</span><span class="nb">t</span><span class="nb">r</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">)</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">c</span><span class="k">o</span><span class="k">n</span><span class="k">t</span><span class="k">i</span><span class="k">n</span><span class="k">u</span><span class="k">e</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class="n">s</span><span class="p">[</span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class="n">_</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">]</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">p</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">_</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">p</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">_</span><span class="n">b</span><span class="n">o</span><span class="n">x</span><span class="p">(</span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class="o">.</span><span class="vm">_</span><span class="vm">_</span><span class="vm">c</span><span class="vm">l</span><span class="vm">a</span><span class="vm">s</span><span class="vm">s</span><span class="vm">_</span><span class="vm">_</span><span class="o">.</span><span class="vm">_</span><span class="vm">_</span><span class="vm">n</span><span class="vm">a</span><span class="vm">m</span><span class="vm">e</span><span class="vm">_</span><span class="vm">_</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="n">g</span><span class="n">r</span><span class="n">a</span><span class="n">m</span><span class="n">m</span><span class="n">a</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="n">u</span><span class="n">n</span><span class="p">(</span><span class="s2">"</span><span class="s2">e</span><span class="s2">x</span><span class="s2">p</span><span class="s2">r</span><span class="s2">"</span><span class="p">,</span><span class=""> </span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">p</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">_</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">e</span><span class="k">x</span><span class="k">c</span><span class="k">e</span><span class="k">p</span><span class="k">t</span><span class=""> </span><span class="n">_</span><span class="n">M</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">E</span><span class="n">r</span><span class="n">r</span><span class="n">o</span><span class="n">r</span><span class=""> </span><span class="k">a</span><span class="k">s</span><span class=""> </span><span class="n">e</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">y</span><span class="n">s</span><span class="o">.</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="n">e</span><span class="n">r</span><span class="n">r</span><span class="o">.</span><span class="n">w</span><span class="n">r</span><span class="n">i</span><span class="n">t</span><span class="n">e</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">d</span><span class="n">e</span><span class="n">s</span><span class="n">c</span><span class="n">r</span><span class="n">i</span><span class="n">b</span><span class="n">e</span><span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">p</span><span class="nf">r</span><span class="nf">i</span><span class="nf">n</span><span class="nf">t</span><span class="nf">_</span><span class="nf">b</span><span class="nf">o</span><span class="nf">x</span><span class="p">(</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">r</span><span class="k">i</span><span class="k">n</span><span class="k">t</span><span class="p">(</span><span class="s2">"</span><span class="s2">"</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">r</span><span class="k">i</span><span class="k">n</span><span class="k">t</span><span class="p">(</span><span class="s2">"</span><span class="s2">=</span><span class="s2">V</span><span class="s2">{</span><span class="s2">}</span><span class="s2">=</span><span class="s2">=</span><span class="s2">"</span><span class="o">.</span><span class="n">f</span><span class="n">o</span><span class="n">r</span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="p">(</span><span class="s2">"</span><span class="s2"> </span><span class="s2">{</span><span class="s2">}</span><span class="s2"> </span><span class="s2">"</span><span class="o">.</span><span class="n">f</span><span class="n">o</span><span class="n">r</span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="p">(</span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">c</span><span class="n">e</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="mi">2</span><span class="mi">8</span><span class="p">,</span><span class=""> </span><span class="s2">"</span><span class="s2">=</span><span class="s2">"</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">r</span><span class="k">i</span><span class="k">n</span><span class="k">t</span><span class="p">(</span><span class="s2">"</span><span class="s2">"</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">p</span><span class="nf">r</span><span class="nf">i</span><span class="nf">n</span><span class="nf">t</span><span class="nf">_</span><span class="nf">e</span><span class="nf">x</span><span class="nf">p</span><span class="nf">r</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">i</span><span class="k">f</span><span class=""> </span><span class="nb">i</span><span class="nb">s</span><span class="nb">i</span><span class="nb">n</span><span class="nb">s</span><span class="nb">t</span><span class="nb">a</span><span class="nb">n</span><span class="nb">c</span><span class="nb">e</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="nb">s</span><span class="nb">t</span><span class="nb">r</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">r</span><span class="k">i</span><span class="k">n</span><span class="k">t</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="o">.</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">p</span><span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">e</span><span class="k">l</span><span class="k">s</span><span class="k">e</span><span class="p">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">p</span><span class="n">p</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="o">.</span><span class="n">p</span><span class="n">p</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="p">(</span><span class="n">e</span><span class="n">x</span><span class="n">p</span><span class="n">r</span><span class="p">,</span><span class=""> </span><span class="n">w</span><span class="n">i</span><span class="n">d</span><span class="n">t</span><span class="n">h</span><span class="o">=</span><span class="mi">2</span><span class="mi">0</span><span class="p">)</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>gas.sh</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="nb">s</span><span class="nb">e</span><span class="nb">t</span><span class=""> </span><span class="">-</span><span class="">e</span><span class="">
</span><span class="">
</span><span class="">c</span><span class="">a</span><span class="">t</span><span class=""> </span><span class="p">|</span><span class=""> </span><span class="">b</span><span class="">a</span><span class="">s</span><span class="">h</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">m</span><span class="">p</span><span class="">i</span><span class="">l</span><span class="">e</span><span class="">.</span><span class="">s</span><span class="">h</span><span class=""> </span><span class="">p</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">a</span><span class="">c</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">g</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">x</span><span class="">c</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">g</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">g</span><span class="">a</span><span class="">s</span><span class=""> </span><span class="">@</span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">.</span><span class="">s</span><span class="">
</span><span class="">
</span><span class="">g</span><span class="">c</span><span class="">c</span><span class=""> </span><span class="">d</span><span class="">r</span><span class="">i</span><span class="">v</span><span class="">e</span><span class="">r</span><span class="">.</span><span class="">c</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">.</span><span class="">s</span><span class=""> </span><span class="">-</span><span class="">o</span><span class=""> </span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">
</span><span class="">
</span><span class="nb">e</span><span class="nb">c</span><span class="nb">h</span><span class="nb">o</span><span class=""> </span><span class="s2">"</span><span class="s2">"</span><span class="">
</span><span class="nb">e</span><span class="nb">c</span><span class="nb">h</span><span class="nb">o</span><span class=""> </span><span class="s2">"</span><span class="s2">=</span><span class="s2">V</span><span class="s2">=</span><span class="s2">=</span><span class="s2">=</span><span class="s2">=</span><span class="s2">=</span><span class="s2"> </span><span class="s2">G</span><span class="s2">c</span><span class="s2">c</span><span class="s2">C</span><span class="s2">o</span><span class="s2">m</span><span class="s2">p</span><span class="s2">i</span><span class="s2">l</span><span class="s2">e</span><span class="s2">A</span><span class="s2">n</span><span class="s2">d</span><span class="s2">R</span><span class="s2">u</span><span class="s2">n</span><span class="s2"> </span><span class="s2">=</span><span class="s2">=</span><span class="s2">=</span><span class="s2">=</span><span class="s2">=</span><span class="s2">=</span><span class="s2">=</span><span class="s2">"</span><span class="">
</span><span class="nb">e</span><span class="nb">c</span><span class="nb">h</span><span class="nb">o</span><span class=""> </span><span class="s2">"</span><span class="s2">"</span><span class="">
</span><span class="">
</span><span class="">.</span><span class="">/</span><span class="">e</span><span class="">x</span><span class="">p</span><span class="">r</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>native.sh</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="nb">s</span><span class="nb">e</span><span class="nb">t</span><span class=""> </span><span class="">-</span><span class="">e</span><span class="">
</span><span class="">
</span><span class="">b</span><span class="">a</span><span class="">s</span><span class="">h</span><span class=""> </span><span class="">c</span><span class="">o</span><span class="">m</span><span class="">p</span><span class="">i</span><span class="">l</span><span class="">e</span><span class="">.</span><span class="">s</span><span class="">h</span><span class=""> </span><span class="">p</span><span class="">a</span><span class="">r</span><span class="">s</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">a</span><span class="">c</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">g</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">x</span><span class="">c</span><span class="">o</span><span class="">d</span><span class="">e</span><span class="">g</span><span class="">e</span><span class="">n</span><span class=""> </span><span class="">a</span><span class="">s</span><span class="">s</span><span class="">e</span><span class="">m</span><span class="">b</span><span class="">l</span><span class="">e</span><span class="">r</span><span class=""> </span><span class="">x</span><span class="">r</span><span class="">u</span><span class="">n</span><span class="">n</span><span class="">e</span><span class="">r</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">X</span><span class="nc">8</span><span class="nc">6</span><span class="nc">R</span><span class="nc">u</span><span class="nc">n</span><span class="nc">n</span><span class="nc">e</span><span class="nc">r</span><span class="p">(</span><span class="nb">o</span><span class="nb">b</span><span class="nb">j</span><span class="nb">e</span><span class="nb">c</span><span class="nb">t</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">d</span><span class="k">e</span><span class="k">f</span><span class=""> </span><span class="nf">r</span><span class="nf">u</span><span class="nf">n</span><span class="p">(</span><span class="bp">s</span><span class="bp">e</span><span class="bp">l</span><span class="bp">f</span><span class="p">,</span><span class=""> </span><span class="n">n</span><span class="n">a</span><span class="n">m</span><span class="n">e</span><span class="p">,</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">c</span><span class="n">h</span><span class="n">i</span><span class="n">n</span><span class="n">e</span><span class="n">_</span><span class="n">c</span><span class="n">o</span><span class="n">d</span><span class="n">e</span><span class="p">)</span><span class="p">:</span><span class="">
</span><span class="cp"> </span><span class="cp"> </span><span class="cp"> </span><span class="cp"> </span><span class="cp"> </span><span class="cp"> </span><span class="cp"> </span><span class="cp"> </span><span class="cp">&lt;</span><span class="cp">&lt;</span><span class="cp">r</span><span class="cp">u</span><span class="cp">n</span><span class="cp"> </span><span class="cp">m</span><span class="cp">a</span><span class="cp">c</span><span class="cp">h</span><span class="cp">i</span><span class="cp">n</span><span class="cp">e</span><span class="cp"> </span><span class="cp">c</span><span class="cp">o</span><span class="cp">d</span><span class="cp">e</span><span class="cp">&gt;</span><span class="cp">&gt;</span><span class="cp">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">r</span><span class="n">e</span><span class="n">s</span><span class="n">u</span><span class="n">l</span><span class="n">t</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>support.py</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="cp">&lt;</span><span class="cp">&lt;</span><span class="cp">c</span><span class="cp">o</span><span class="cp">m</span><span class="cp">p</span><span class="cp">i</span><span class="cp">l</span><span class="cp">e</span><span class="cp">r</span><span class="cp">&gt;</span><span class="cp">&gt;</span><span class="cp">
</span></pre></div>

</div>

]]></summary>
</entry>
<entry>
    <title>DRAFT: Porting RLMeta to C++</title>
    <link href="http://rickardlindberg.me/writing/rlmeta-cpp/" />
    <id>http://rickardlindberg.me/writing/rlmeta-cpp/</id>
    <published>2020-04-10T00:00:00Z</published>
    <updated>2020-04-10T00:00:00Z</updated>
    <summary type="html"><![CDATA[<h1>DRAFT: Porting RLMeta to C++</h1>

<p><em>Published on 2020-04-10.</em></p>

<strong>This is a work in progress that will change. Like to see it finished? Let me know by sending me an email.</strong>

<p>In this article I will port RLMeta to C++. The main reason for doing it is to learn C++. I have the impression that C++ is a large and complex language, but I think I should be able to grasp the basics pretty quickly because I know C quite well and I am also familiar with object oriented programming. This article will describe my learning journey as well as the port. Another reason for doing the port is to see how RLMeta looks like when C++ is the target language. Will it fit well? Will performance increase?</p>

<ul><li><a href="#f935efac99094d30b035430ba6c263cb">Representing data</a>

</li>

<li><a href="#8fe0f8cbf13f49c0a4d9aa4f92fa2540">Misc</a>

</li>

</ul><h2><a name="f935efac99094d30b035430ba6c263cb"></a>Representing data</h2>

<p>The first thing I think about is how to represent the data that RLMeta needs. In particular I think about how to store the mapping between rule names and their location in the program. The map in the C++ standard library looks like a dict in Python. But there is also something about an allocation strategy. I need to learn more about how memory is handled in C++.</p>

<p>I read about classes, constructors, destructors and initialisation. I create a small example to clarify my thinking. Here I also learn about basic C++ syntax.</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">i</span><span class="cpf">o</span><span class="cpf">s</span><span class="cpf">t</span><span class="cpf">r</span><span class="cpf">e</span><span class="cpf">a</span><span class="cpf">m</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="">
</span><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">F</span><span class="nc">o</span><span class="nc">o</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">r</span><span class="k">i</span><span class="k">v</span><span class="k">a</span><span class="k">t</span><span class="k">e</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="n">i</span><span class="n">d</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">u</span><span class="k">b</span><span class="k">l</span><span class="k">i</span><span class="k">c</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">F</span><span class="n">o</span><span class="n">o</span><span class="p">(</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="n">i</span><span class="n">d</span><span class="p">)</span><span class=""> </span><span class="o">:</span><span class=""> </span><span class="n">i</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="n">d</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">C</span><span class="s">r</span><span class="s">e</span><span class="s">a</span><span class="s">t</span><span class="s">i</span><span class="s">n</span><span class="s">g</span><span class="s"> </span><span class="s">f</span><span class="s">o</span><span class="s">o</span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">i</span><span class="n">d</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="o">~</span><span class="n">F</span><span class="n">o</span><span class="n">o</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">D</span><span class="s">e</span><span class="s">s</span><span class="s">t</span><span class="s">r</span><span class="s">u</span><span class="s">c</span><span class="s">t</span><span class="s">i</span><span class="s">n</span><span class="s">g</span><span class="s"> </span><span class="s">f</span><span class="s">o</span><span class="s">o</span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">i</span><span class="n">d</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class="p">}</span><span class="p">;</span><span class="">
</span><span class="">
</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="nf">m</span><span class="nf">a</span><span class="nf">i</span><span class="nf">n</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">E</span><span class="s">n</span><span class="s">t</span><span class="s">e</span><span class="s">r</span><span class="s">i</span><span class="s">n</span><span class="s">g</span><span class="s"> </span><span class="s">m</span><span class="s">a</span><span class="s">i</span><span class="s">n</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">F</span><span class="n">o</span><span class="n">o</span><span class=""> </span><span class="n">f</span><span class="n">o</span><span class="n">o</span><span class="n">1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">F</span><span class="n">o</span><span class="n">o</span><span class=""> </span><span class="o">*</span><span class="n">f</span><span class="n">o</span><span class="n">o</span><span class="n">2</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="k">n</span><span class="k">e</span><span class="k">w</span><span class=""> </span><span class="n">F</span><span class="n">o</span><span class="n">o</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">E</span><span class="s">x</span><span class="s">i</span><span class="s">t</span><span class="s">i</span><span class="s">n</span><span class="s">g</span><span class="s"> </span><span class="s">m</span><span class="s">a</span><span class="s">i</span><span class="s">n</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="mi">0</span><span class="p">;</span><span class="">
</span><span class="p">}</span><span class="">
</span></pre></div>

</div>

<p>Output:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="n">E</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">i</span><span class="n">n</span><span class="">
</span><span class="n">C</span><span class="n">r</span><span class="n">e</span><span class="n">a</span><span class="n">t</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">f</span><span class="n">o</span><span class="n">o</span><span class=""> </span><span class="mi">1</span><span class="">
</span><span class="n">C</span><span class="n">r</span><span class="n">e</span><span class="n">a</span><span class="n">t</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">f</span><span class="n">o</span><span class="n">o</span><span class=""> </span><span class="mi">2</span><span class="">
</span><span class="n">E</span><span class="n">x</span><span class="n">i</span><span class="n">t</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">i</span><span class="n">n</span><span class="">
</span><span class="n">D</span><span class="n">e</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">u</span><span class="n">c</span><span class="n">t</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">f</span><span class="n">o</span><span class="n">o</span><span class=""> </span><span class="mi">1</span><span class="">
</span></pre></div>

</div>

<p>This shows me that objects are destructed automatically if allocated on the stack. But not when newed.</p>

<p>I go back to the map and make a small example to learn how to use it:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">i</span><span class="cpf">o</span><span class="cpf">s</span><span class="cpf">t</span><span class="cpf">r</span><span class="cpf">e</span><span class="cpf">a</span><span class="cpf">m</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">m</span><span class="cpf">a</span><span class="cpf">p</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="">
</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="nf">m</span><span class="nf">a</span><span class="nf">i</span><span class="nf">n</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">m</span><span class="n">a</span><span class="n">p</span><span class="o">&lt;</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class="p">,</span><span class=""> </span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class="o">&gt;</span><span class=""> </span><span class="n">r</span><span class="n">u</span><span class="n">l</span><span class="n">e</span><span class="n">s</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">r</span><span class="n">u</span><span class="n">l</span><span class="n">e</span><span class="n">s</span><span class="p">.</span><span class="n">i</span><span class="n">n</span><span class="n">s</span><span class="n">e</span><span class="n">r</span><span class="n">t</span><span class="p">(</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">p</span><span class="n">a</span><span class="n">i</span><span class="n">r</span><span class="o">&lt;</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class="p">,</span><span class=""> </span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"</span><span class="s">f</span><span class="s">o</span><span class="s">o</span><span class="s">"</span><span class="p">,</span><span class=""> </span><span class="mi">1</span><span class="mi">0</span><span class="p">)</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">r</span><span class="n">u</span><span class="n">l</span><span class="n">e</span><span class="n">s</span><span class="p">.</span><span class="n">i</span><span class="n">n</span><span class="n">s</span><span class="n">e</span><span class="n">r</span><span class="n">t</span><span class="p">(</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">p</span><span class="n">a</span><span class="n">i</span><span class="n">r</span><span class="o">&lt;</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class="p">,</span><span class=""> </span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"</span><span class="s">b</span><span class="s">a</span><span class="s">r</span><span class="s">"</span><span class="p">,</span><span class=""> </span><span class="mi">1</span><span class="mi">5</span><span class="p">)</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">f</span><span class="s">o</span><span class="s">o</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">r</span><span class="n">u</span><span class="n">l</span><span class="n">e</span><span class="n">s</span><span class="p">[</span><span class="s">"</span><span class="s">f</span><span class="s">o</span><span class="s">o</span><span class="s">"</span><span class="p">]</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">b</span><span class="s">a</span><span class="s">r</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">r</span><span class="n">u</span><span class="n">l</span><span class="n">e</span><span class="n">s</span><span class="p">[</span><span class="s">"</span><span class="s">b</span><span class="s">a</span><span class="s">r</span><span class="s">"</span><span class="p">]</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="mi">0</span><span class="p">;</span><span class="">
</span><span class="p">}</span><span class="">
</span></pre></div>

</div>

<p>Output:</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="n">f</span><span class="n">o</span><span class="n">o</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">1</span><span class="mi">0</span><span class="">
</span><span class="n">b</span><span class="n">a</span><span class="n">r</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">1</span><span class="mi">5</span><span class="">
</span></pre></div>

</div>

<p>I think the type declarations make the code hard to read. But the map seems to do what I want. So I'm happy. I also conclude that the map allocates memory to make space for all pairs. But at the end of <code>main</code> it will all be freed automatically. So no memory will leak.</p>

<p>Next I'm thinking about how to represent instructions. In the Python version an instruction is represented as a tuple <code>(name, arg1, arg2)</code>. Where the arguments can be of arbitrary type (string, integer, lambda, etc.).</p>

<p>Getting stuck. I think about how to represent the values that RLMeta works with instead. Lists, strings, integers, characters.</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">i</span><span class="cpf">o</span><span class="cpf">s</span><span class="cpf">t</span><span class="cpf">r</span><span class="cpf">e</span><span class="cpf">a</span><span class="cpf">m</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">l</span><span class="cpf">i</span><span class="cpf">s</span><span class="cpf">t</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">m</span><span class="cpf">e</span><span class="cpf">m</span><span class="cpf">o</span><span class="cpf">r</span><span class="cpf">y</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="">
</span><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">R</span><span class="nc">L</span><span class="nc">M</span><span class="nc">e</span><span class="nc">t</span><span class="nc">a</span><span class="nc">O</span><span class="nc">b</span><span class="nc">j</span><span class="nc">e</span><span class="nc">c</span><span class="nc">t</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">u</span><span class="k">b</span><span class="k">l</span><span class="k">i</span><span class="k">c</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">v</span><span class="k">i</span><span class="k">r</span><span class="k">t</span><span class="k">u</span><span class="k">a</span><span class="k">l</span><span class=""> </span><span class="o">~</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class="p">}</span><span class="p">;</span><span class="">
</span><span class="">
</span><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">R</span><span class="nc">L</span><span class="nc">M</span><span class="nc">e</span><span class="nc">t</span><span class="nc">a</span><span class="nc">I</span><span class="nc">n</span><span class="nc">t</span><span class="nc">e</span><span class="nc">g</span><span class="nc">e</span><span class="nc">r</span><span class=""> </span><span class="o">:</span><span class=""> </span><span class="k">p</span><span class="k">u</span><span class="k">b</span><span class="k">l</span><span class="k">i</span><span class="k">c</span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">r</span><span class="k">i</span><span class="k">v</span><span class="k">a</span><span class="k">t</span><span class="k">e</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">u</span><span class="k">b</span><span class="k">l</span><span class="k">i</span><span class="k">c</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">)</span><span class=""> </span><span class="o">:</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">(</span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="o">~</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">D</span><span class="s">e</span><span class="s">s</span><span class="s">t</span><span class="s">r</span><span class="s">u</span><span class="s">c</span><span class="s">t</span><span class="s">i</span><span class="s">n</span><span class="s">g</span><span class="s"> </span><span class="s">i</span><span class="s">n</span><span class="s">t</span><span class="s">e</span><span class="s">g</span><span class="s">e</span><span class="s">r</span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class="p">}</span><span class="p">;</span><span class="">
</span><span class="">
</span><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">R</span><span class="nc">L</span><span class="nc">M</span><span class="nc">e</span><span class="nc">t</span><span class="nc">a</span><span class="nc">S</span><span class="nc">t</span><span class="nc">r</span><span class="nc">i</span><span class="nc">n</span><span class="nc">g</span><span class=""> </span><span class="o">:</span><span class=""> </span><span class="k">p</span><span class="k">u</span><span class="k">b</span><span class="k">l</span><span class="k">i</span><span class="k">c</span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">r</span><span class="k">i</span><span class="k">v</span><span class="k">a</span><span class="k">t</span><span class="k">e</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">u</span><span class="k">b</span><span class="k">l</span><span class="k">i</span><span class="k">c</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">S</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class="p">(</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">)</span><span class=""> </span><span class="o">:</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">(</span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="o">~</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">S</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">D</span><span class="s">e</span><span class="s">s</span><span class="s">t</span><span class="s">r</span><span class="s">u</span><span class="s">c</span><span class="s">t</span><span class="s">i</span><span class="s">n</span><span class="s">g</span><span class="s"> </span><span class="s">s</span><span class="s">t</span><span class="s">r</span><span class="s">i</span><span class="s">n</span><span class="s">g</span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class="p">}</span><span class="p">;</span><span class="">
</span><span class="">
</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="nf">m</span><span class="nf">a</span><span class="nf">i</span><span class="nf">n</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">l</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="o">&lt;</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="o">&gt;</span><span class=""> </span><span class="n">o</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="n">s</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">o</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="n">s</span><span class="p">.</span><span class="n">p</span><span class="n">u</span><span class="n">s</span><span class="n">h</span><span class="n">_</span><span class="n">b</span><span class="n">a</span><span class="n">c</span><span class="n">k</span><span class="p">(</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">o</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="n">s</span><span class="p">.</span><span class="n">p</span><span class="n">u</span><span class="n">s</span><span class="n">h</span><span class="n">_</span><span class="n">b</span><span class="n">a</span><span class="n">c</span><span class="n">k</span><span class="p">(</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">S</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class="p">(</span><span class="s">"</span><span class="s">h</span><span class="s">e</span><span class="s">l</span><span class="s">l</span><span class="s">o</span><span class="s">"</span><span class="p">)</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">l</span><span class="n">i</span><span class="n">s</span><span class="n">t</span><span class="o">&lt;</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">u</span><span class="n">n</span><span class="n">i</span><span class="n">q</span><span class="n">u</span><span class="n">e</span><span class="n">_</span><span class="n">p</span><span class="n">t</span><span class="n">r</span><span class="o">&lt;</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="o">&gt;</span><span class="o">&gt;</span><span class=""> </span><span class="n">o</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="n">P</span><span class="n">o</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="n">s</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">o</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="n">P</span><span class="n">o</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="n">s</span><span class="p">.</span><span class="n">p</span><span class="n">u</span><span class="n">s</span><span class="n">h</span><span class="n">_</span><span class="n">b</span><span class="n">a</span><span class="n">c</span><span class="n">k</span><span class="p">(</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">m</span><span class="n">a</span><span class="n">k</span><span class="n">e</span><span class="n">_</span><span class="n">u</span><span class="n">n</span><span class="n">i</span><span class="n">q</span><span class="n">u</span><span class="n">e</span><span class="o">&lt;</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">o</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="n">P</span><span class="n">o</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">r</span><span class="n">s</span><span class="p">.</span><span class="n">p</span><span class="n">u</span><span class="n">s</span><span class="n">h</span><span class="n">_</span><span class="n">b</span><span class="n">a</span><span class="n">c</span><span class="n">k</span><span class="p">(</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">m</span><span class="n">a</span><span class="n">k</span><span class="n">e</span><span class="n">_</span><span class="n">u</span><span class="n">n</span><span class="n">i</span><span class="n">q</span><span class="n">u</span><span class="n">e</span><span class="o">&lt;</span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">S</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"</span><span class="s">w</span><span class="s">o</span><span class="s">r</span><span class="s">l</span><span class="s">d</span><span class="s">"</span><span class="p">)</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="mi">0</span><span class="p">;</span><span class="">
</span><span class="p">}</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="n">D</span><span class="n">e</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">u</span><span class="n">c</span><span class="n">t</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="mi">5</span><span class="">
</span><span class="n">D</span><span class="n">e</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">u</span><span class="n">c</span><span class="n">t</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">h</span><span class="n">e</span><span class="n">l</span><span class="n">l</span><span class="n">o</span><span class="">
</span><span class="n">D</span><span class="n">e</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">u</span><span class="n">c</span><span class="n">t</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="mi">6</span><span class="">
</span><span class="n">D</span><span class="n">e</span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">u</span><span class="n">c</span><span class="n">t</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">r</span><span class="n">i</span><span class="n">n</span><span class="n">g</span><span class=""> </span><span class="n">w</span><span class="n">o</span><span class="n">r</span><span class="n">l</span><span class="n">d</span><span class="">
</span></pre></div>

</div>

<p>Since C++ containers can not store objects of arbitrary type, I introduce a base class. I also experiment with smart pointers. I find out that a virtual destructor is needed to make proper destruction. That really confused me.</p>

<p>Dynamic cast can work as <code>isinstance</code> in Python.</p>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">i</span><span class="cpf">o</span><span class="cpf">s</span><span class="cpf">t</span><span class="cpf">r</span><span class="cpf">e</span><span class="cpf">a</span><span class="cpf">m</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">l</span><span class="cpf">i</span><span class="cpf">s</span><span class="cpf">t</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="cp">#</span><span class="cp">i</span><span class="cp">n</span><span class="cp">c</span><span class="cp">l</span><span class="cp">u</span><span class="cp">d</span><span class="cp">e</span><span class=""> </span><span class="cpf">&lt;</span><span class="cpf">m</span><span class="cpf">e</span><span class="cpf">m</span><span class="cpf">o</span><span class="cpf">r</span><span class="cpf">y</span><span class="cpf">&gt;</span><span class="cp">
</span><span class="">
</span><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">R</span><span class="nc">L</span><span class="nc">M</span><span class="nc">e</span><span class="nc">t</span><span class="nc">a</span><span class="nc">O</span><span class="nc">b</span><span class="nc">j</span><span class="nc">e</span><span class="nc">c</span><span class="nc">t</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">v</span><span class="k">i</span><span class="k">r</span><span class="k">t</span><span class="k">u</span><span class="k">a</span><span class="k">l</span><span class=""> </span><span class="kt">b</span><span class="kt">o</span><span class="kt">o</span><span class="kt">l</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">e</span><span class="n">s</span><span class="p">(</span><span class="k">c</span><span class="k">o</span><span class="k">n</span><span class="k">s</span><span class="k">t</span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class=""> </span><span class="o">&amp;</span><span class="n">o</span><span class="n">t</span><span class="n">h</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="nb">f</span><span class="nb">a</span><span class="nb">l</span><span class="nb">s</span><span class="nb">e</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class="p">}</span><span class="p">;</span><span class="">
</span><span class="">
</span><span class="k">c</span><span class="k">l</span><span class="k">a</span><span class="k">s</span><span class="k">s</span><span class=""> </span><span class="nc">R</span><span class="nc">L</span><span class="nc">M</span><span class="nc">e</span><span class="nc">t</span><span class="nc">a</span><span class="nc">I</span><span class="nc">n</span><span class="nc">t</span><span class="nc">e</span><span class="nc">g</span><span class="nc">e</span><span class="nc">r</span><span class=""> </span><span class="o">:</span><span class=""> </span><span class="k">p</span><span class="k">u</span><span class="k">b</span><span class="k">l</span><span class="k">i</span><span class="k">c</span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">r</span><span class="k">i</span><span class="k">v</span><span class="k">a</span><span class="k">t</span><span class="k">e</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">p</span><span class="k">u</span><span class="k">b</span><span class="k">l</span><span class="k">i</span><span class="k">c</span><span class="o">:</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">)</span><span class=""> </span><span class="o">:</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">(</span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="kt">b</span><span class="kt">o</span><span class="kt">o</span><span class="kt">l</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">e</span><span class="n">s</span><span class="p">(</span><span class="k">c</span><span class="k">o</span><span class="k">n</span><span class="k">s</span><span class="k">t</span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class=""> </span><span class="o">&amp;</span><span class="n">o</span><span class="n">t</span><span class="n">h</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">t</span><span class="k">r</span><span class="k">y</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">c</span><span class="k">o</span><span class="k">n</span><span class="k">s</span><span class="k">t</span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="o">&amp;</span><span class="n">o</span><span class="n">t</span><span class="n">h</span><span class="n">e</span><span class="n">r</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="k">d</span><span class="k">y</span><span class="k">n</span><span class="k">a</span><span class="k">m</span><span class="k">i</span><span class="k">c</span><span class="k">_</span><span class="k">c</span><span class="k">a</span><span class="k">s</span><span class="k">t</span><span class="o">&lt;</span><span class="k">c</span><span class="k">o</span><span class="k">n</span><span class="k">s</span><span class="k">t</span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="o">&amp;</span><span class="o">&gt;</span><span class="p">(</span><span class="n">o</span><span class="n">t</span><span class="n">h</span><span class="n">e</span><span class="n">r</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="n">o</span><span class="n">t</span><span class="n">h</span><span class="n">e</span><span class="n">r</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="p">.</span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class=""> </span><span class="o">=</span><span class="o">=</span><span class=""> </span><span class="n">v</span><span class="n">a</span><span class="n">l</span><span class="n">u</span><span class="n">e</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class=""> </span><span class="k">c</span><span class="k">a</span><span class="k">t</span><span class="k">c</span><span class="k">h</span><span class=""> </span><span class="p">(</span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">b</span><span class="n">a</span><span class="n">d</span><span class="n">_</span><span class="n">c</span><span class="n">a</span><span class="n">s</span><span class="n">t</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="p">}</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="nb">f</span><span class="nb">a</span><span class="nb">l</span><span class="nb">s</span><span class="nb">e</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="p">}</span><span class="">
</span><span class="p">}</span><span class="p">;</span><span class="">
</span><span class="">
</span><span class="kt">i</span><span class="kt">n</span><span class="kt">t</span><span class=""> </span><span class="nf">m</span><span class="nf">a</span><span class="nf">i</span><span class="nf">n</span><span class="p">(</span><span class="p">)</span><span class=""> </span><span class="p">{</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class=""> </span><span class="n">o</span><span class="n">b</span><span class="n">j</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">5</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">R</span><span class="n">L</span><span class="n">M</span><span class="n">e</span><span class="n">t</span><span class="n">a</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class=""> </span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">6</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">I</span><span class="s">n</span><span class="s">t</span><span class="s">e</span><span class="s">g</span><span class="s">e</span><span class="s">r</span><span class="s">(</span><span class="s">5</span><span class="s">)</span><span class="s"> </span><span class="s">m</span><span class="s">a</span><span class="s">t</span><span class="s">c</span><span class="s">h</span><span class="s">e</span><span class="s">s</span><span class="s"> </span><span class="s">O</span><span class="s">b</span><span class="s">j</span><span class="s">e</span><span class="s">c</span><span class="s">t</span><span class="s">?</span><span class="s"> </span><span class="s"> </span><span class="s"> </span><span class="s"> </span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">5</span><span class="p">.</span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">e</span><span class="n">s</span><span class="p">(</span><span class="n">o</span><span class="n">b</span><span class="n">j</span><span class="p">)</span><span class=""> </span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">I</span><span class="s">n</span><span class="s">t</span><span class="s">e</span><span class="s">g</span><span class="s">e</span><span class="s">r</span><span class="s">(</span><span class="s">5</span><span class="s">)</span><span class="s"> </span><span class="s">m</span><span class="s">a</span><span class="s">t</span><span class="s">c</span><span class="s">h</span><span class="s">e</span><span class="s">s</span><span class="s"> </span><span class="s">I</span><span class="s">n</span><span class="s">t</span><span class="s">e</span><span class="s">g</span><span class="s">e</span><span class="s">r</span><span class="s">(</span><span class="s">6</span><span class="s">)</span><span class="s">?</span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">5</span><span class="p">.</span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">e</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">6</span><span class="p">)</span><span class=""> </span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="n">s</span><span class="n">t</span><span class="n">d</span><span class="o">:</span><span class="o">:</span><span class="n">c</span><span class="n">o</span><span class="n">u</span><span class="n">t</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="s">I</span><span class="s">n</span><span class="s">t</span><span class="s">e</span><span class="s">g</span><span class="s">e</span><span class="s">r</span><span class="s">(</span><span class="s">6</span><span class="s">)</span><span class="s"> </span><span class="s">m</span><span class="s">a</span><span class="s">t</span><span class="s">c</span><span class="s">h</span><span class="s">e</span><span class="s">s</span><span class="s"> </span><span class="s">I</span><span class="s">n</span><span class="s">t</span><span class="s">e</span><span class="s">g</span><span class="s">e</span><span class="s">r</span><span class="s">(</span><span class="s">6</span><span class="s">)</span><span class="s">?</span><span class="s"> </span><span class="s">"</span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">6</span><span class="p">.</span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">e</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="n">n</span><span class="n">t</span><span class="n">6</span><span class="p">)</span><span class=""> </span><span class=""> </span><span class="o">&lt;</span><span class="o">&lt;</span><span class=""> </span><span class="s">"</span><span class="se">\</span><span class="se">n</span><span class="s">"</span><span class="p">;</span><span class="">
</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="k">r</span><span class="k">e</span><span class="k">t</span><span class="k">u</span><span class="k">r</span><span class="k">n</span><span class=""> </span><span class="mi">0</span><span class="p">;</span><span class="">
</span><span class="p">}</span><span class="">
</span></pre></div>

</div>

<div class="rliterate-code"><div class="rliterate-code-body"><pre><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">e</span><span class="n">s</span><span class=""> </span><span class="n">O</span><span class="n">b</span><span class="n">j</span><span class="n">e</span><span class="n">c</span><span class="n">t</span><span class="o">?</span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class=""> </span><span class="mi">0</span><span class="">
</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">e</span><span class="n">s</span><span class=""> </span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">?</span><span class=""> </span><span class="mi">0</span><span class="">
</span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class=""> </span><span class="n">m</span><span class="n">a</span><span class="n">t</span><span class="n">c</span><span class="n">h</span><span class="n">e</span><span class="n">s</span><span class=""> </span><span class="n">I</span><span class="n">n</span><span class="n">t</span><span class="n">e</span><span class="n">g</span><span class="n">e</span><span class="n">r</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">?</span><span class=""> </span><span class="mi">1</span><span class="">
</span></pre></div>

</div>

<p>For this to work, there has to be some virtual member in the base class.</p>

<h2><a name="8fe0f8cbf13f49c0a4d9aa4f92fa2540"></a>Misc</h2>

<div class="rliterate-code"><div class="rliterate-code-header"><ol class="rliterate-code-path"><li>runcpp.sh</li></ol>

</div>

<div class="rliterate-code-body"><pre><span class="">c</span><span class="">a</span><span class="">t</span><span class=""> </span><span class="">&gt;</span><span class=""> </span><span class="">t</span><span class="">m</span><span class="">p</span><span class="">.</span><span class="">c</span><span class="">p</span><span class="">p</span><span class=""> </span><span class="o">&amp;</span><span class="o">&amp;</span><span class=""> </span><span class="">g</span><span class="">+</span><span class="">+</span><span class=""> </span><span class="">t</span><span class="">m</span><span class="">p</span><span class="">.</span><span class="">c</span><span class="">p</span><span class="">p</span><span class=""> </span><span class="">-</span><span class="">o</span><span class=""> </span><span class="">t</span><span class="">m</span><span class="">p</span><span class=""> </span><span class="o">&amp;</span><span class="o">&amp;</span><span class=""> </span><span class="">.</span><span class="">/</span><span class="">t</span><span class="">m</span><span class="">p</span><span class=""> </span><span class="o">&amp;</span><span class="o">&amp;</span><span class=""> </span><span class="">r</span><span class="">m</span><span class=""> </span><span class="">t</span><span class="">m</span><span class="">p</span><span class="">.</span><span class="">c</span><span class="">p</span><span class="">p</span><span class=""> </span><span class="">t</span><span class="">m</span><span class="">p</span><span class="">
</span></pre></div>

</div>

]]></summary>
</entry>
<entry>
    <title>DRAFT: Parsing off-side rule languages with RLMeta</title>
    <link href="http://rickardlindberg.me/writing/draft-rlmeta-offside/" />
    <id>http://rickardlindberg.me/writing/draft-rlmeta-offside/</id>
    <published>2019-06-27T00:00:00Z</published>
    <updated>2019-06-27T00:00:00Z</updated>
    <summary type="html"><![CDATA[<h1>DRAFT: Parsing off-side rule languages with RLMeta</h1>

<p><em>Published on 2019-06-27.</em></p>

<strong>This is a work in progress that will change. Like to see it finished? Let me know by sending me an email.</strong>

<p>In this article I describe how to parse <a href="https://en.wikipedia.org/wiki/Off-side_rule">off-side rule</a> languages using RLMeta.</p>

<ul><li><a href="#d44bd1779e9f4cdab7ac14e0b23ad3bf">Markdown</a>

</li>

<li><a href="#c2cd13666c264ac2bcfde34ec81f77b5">Python</a>

</li>

<li><a href="#5cca99df2e2c4c78ab4bfe4cb946d89a">Notes</a>

</li>

</ul><h2><a name="d44bd1779e9f4cdab7ac14e0b23ad3bf"></a>Markdown</h2>

<h2><a name="c2cd13666c264ac2bcfde34ec81f77b5"></a>Python</h2>

<h2><a name="5cca99df2e2c4c78ab4bfe4cb946d89a"></a>Notes</h2>

<p>Got the idea from <a href="https://github.com/jgm/peg-markdown/">A PEG Markdown parser</a>.</p>

<p>Failure messages will have wrong location.</p>

]]></summary>
</entry>

</feed>
